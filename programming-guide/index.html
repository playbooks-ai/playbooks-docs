
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Build AI Agents with Natural Language Programming">
      
      
      
        <link rel="canonical" href="https://github.com/playbooks-ai/playbooks/programming-guide/">
      
      
        <link rel="prev" href="../getting-started/migrating/">
      
      
        <link rel="next" href="../tutorials/">
      
      
      <link rel="icon" href="../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.12">
    
    
      
        <title>Programming Guide - Playbooks AI</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.2afb09e1.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Google+Sans:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Google Sans";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../assets/stylesheets/custom.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-KSV70W8EXP"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-KSV70W8EXP",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-KSV70W8EXP",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="slate" data-md-color-accent="slate">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#playbooks-programming-guide" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Playbooks AI" class="md-header__button md-logo" aria-label="Playbooks AI" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80v352c0 17.4 9.4 33.4 24.5 41.9S58.2 482 73 473l288-176c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Playbooks AI
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Programming Guide
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="slate" data-md-color-accent="slate"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/playbooks-ai/playbooks" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    playbooks
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Playbooks AI" class="md-nav__button md-logo" aria-label="Playbooks AI" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80v352c0 17.4 9.4 33.4 24.5 41.9S58.2 482 73 473l288-176c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41z"/></svg>

    </a>
    Playbooks AI
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/playbooks-ai/playbooks" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    playbooks
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../getting-started/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/ai-assistants/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AI Coding Assistants
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/migrating/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Migrating from Other Agent Frameworks
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Programming Guide
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Programming Guide
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    <span class="md-ellipsis">
      Table of Contents
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#core-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      Core Concepts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Core Concepts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#philosophy-software-30" class="md-nav__link">
    <span class="md-ellipsis">
      Philosophy: Software 3.0
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-abstractions" class="md-nav__link">
    <span class="md-ellipsis">
      Key Abstractions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#language-syntax-and-formatting" class="md-nav__link">
    <span class="md-ellipsis">
      Language Syntax and Formatting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Language Syntax and Formatting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#file-structure" class="md-nav__link">
    <span class="md-ellipsis">
      File Structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formatting-rules" class="md-nav__link">
    <span class="md-ellipsis">
      Formatting Rules
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-five-playbook-types" class="md-nav__link">
    <span class="md-ellipsis">
      The Five Playbook Types
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The Five Playbook Types">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#decision-framework" class="md-nav__link">
    <span class="md-ellipsis">
      Decision Framework
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1-markdown-playbooks-structured-workflows" class="md-nav__link">
    <span class="md-ellipsis">
      1. Markdown Playbooks - Structured Workflows
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-react-playbooks-dynamic-reasoning" class="md-nav__link">
    <span class="md-ellipsis">
      2. ReAct Playbooks - Dynamic Reasoning
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-raw-prompt-playbooks-full-control" class="md-nav__link">
    <span class="md-ellipsis">
      3. Raw Prompt Playbooks - Full Control
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-python-playbooks-hard-logic" class="md-nav__link">
    <span class="md-ellipsis">
      4. Python Playbooks - Hard Logic
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#when-to-extract-python-playbooks-to-mcp-server" class="md-nav__link">
    <span class="md-ellipsis">
      When to Extract Python Playbooks to MCP Server
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-external-playbooks-remote-tools" class="md-nav__link">
    <span class="md-ellipsis">
      5. External Playbooks - Remote Tools
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#decomposing-tasks-into-playbooks" class="md-nav__link">
    <span class="md-ellipsis">
      Decomposing Tasks into Playbooks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Decomposing Tasks into Playbooks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#decomposition-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      Decomposition Strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#granularity-guidelines" class="md-nav__link">
    <span class="md-ellipsis">
      Granularity Guidelines
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#when-to-create-separate-playbooks" class="md-nav__link">
    <span class="md-ellipsis">
      When to Create Separate Playbooks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#natural-language-vs-explicit-syntax" class="md-nav__link">
    <span class="md-ellipsis">
      Natural Language vs Explicit Syntax
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Natural Language vs Explicit Syntax">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-spectrum-of-explicitness" class="md-nav__link">
    <span class="md-ellipsis">
      The Spectrum of Explicitness
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#variable-assignment" class="md-nav__link">
    <span class="md-ellipsis">
      Variable Assignment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#when-to-use-each-style" class="md-nav__link">
    <span class="md-ellipsis">
      When to Use Each Style
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-call-syntax-options" class="md-nav__link">
    <span class="md-ellipsis">
      Function Call Syntax Options
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multi-agent-programs" class="md-nav__link">
    <span class="md-ellipsis">
      Multi-Agent Programs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Multi-Agent Programs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#when-to-use-multiple-agents" class="md-nav__link">
    <span class="md-ellipsis">
      When to Use Multiple Agents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-multiple-agents" class="md-nav__link">
    <span class="md-ellipsis">
      Creating Multiple Agents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agent-communication-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Agent Communication Methods
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Agent Communication Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-direct-public-playbook-calls" class="md-nav__link">
    <span class="md-ellipsis">
      1. Direct Public Playbook Calls
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-natural-language-messaging" class="md-nav__link">
    <span class="md-ellipsis">
      2. Natural Language Messaging
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-meetings-multi-party-coordination" class="md-nav__link">
    <span class="md-ellipsis">
      3. Meetings - Multi-Party Coordination
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multi-agent-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Multi-Agent Best Practices
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#triggers-event-driven-programming" class="md-nav__link">
    <span class="md-ellipsis">
      Triggers: Event-Driven Programming
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Triggers: Event-Driven Programming">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#why-use-triggers" class="md-nav__link">
    <span class="md-ellipsis">
      Why Use Triggers?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#when-to-use-triggers" class="md-nav__link">
    <span class="md-ellipsis">
      When to Use Triggers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-validation-pattern-before-after" class="md-nav__link">
    <span class="md-ellipsis">
      The Validation Pattern: Before &amp; After
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trigger-types" class="md-nav__link">
    <span class="md-ellipsis">
      Trigger Types
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-trigger-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      Common Trigger Patterns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-triggers-simplify-programs" class="md-nav__link">
    <span class="md-ellipsis">
      How Triggers Simplify Programs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trigger-execution-model" class="md-nav__link">
    <span class="md-ellipsis">
      Trigger Execution Model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#when-not-to-use-triggers" class="md-nav__link">
    <span class="md-ellipsis">
      When NOT to Use Triggers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trigger-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Trigger Best Practices
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#description-placeholders" class="md-nav__link">
    <span class="md-ellipsis">
      Description Placeholders
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Description Placeholders">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Basic Usage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-you-can-use" class="md-nav__link">
    <span class="md-ellipsis">
      What You Can Use
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      Common Patterns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Best Practices
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#artifacts-and-memory" class="md-nav__link">
    <span class="md-ellipsis">
      Artifacts and Memory
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Artifacts and Memory">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#artifacts-persistent-files-alpha-feature" class="md-nav__link">
    <span class="md-ellipsis">
      Artifacts - Persistent Files (alpha feature)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#when-to-use-artifacts" class="md-nav__link">
    <span class="md-ellipsis">
      When to Use Artifacts
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common-patterns-and-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Common Patterns and Best Practices
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Common Patterns and Best Practices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pattern-conversational-input-collection" class="md-nav__link">
    <span class="md-ellipsis">
      Pattern: Conversational Input Collection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pattern-validation-with-triggers" class="md-nav__link">
    <span class="md-ellipsis">
      Pattern: Validation with Triggers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pattern-python-markdown-composition" class="md-nav__link">
    <span class="md-ellipsis">
      Pattern: Python ↔ Markdown Composition
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pattern-batch-operations" class="md-nav__link">
    <span class="md-ellipsis">
      Pattern: Batch Operations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pattern-error-handling" class="md-nav__link">
    <span class="md-ellipsis">
      Pattern: Error Handling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pattern-meeting-facilitation" class="md-nav__link">
    <span class="md-ellipsis">
      Pattern: Meeting Facilitation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pattern-collecting-inputs-from-user" class="md-nav__link">
    <span class="md-ellipsis">
      Pattern: Collecting Inputs from User
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pattern-mock-backend-interactions-with-python-playbooks" class="md-nav__link">
    <span class="md-ellipsis">
      Pattern: Mock Backend Interactions with Python Playbooks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#best-practices-summary" class="md-nav__link">
    <span class="md-ellipsis">
      Best Practices Summary
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#editing-existing-programs" class="md-nav__link">
    <span class="md-ellipsis">
      Editing Existing Programs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Editing Existing Programs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#surgical-editing-principles" class="md-nav__link">
    <span class="md-ellipsis">
      Surgical Editing Principles
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-edit-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      Common Edit Patterns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-edit-request" class="md-nav__link">
    <span class="md-ellipsis">
      Example Edit Request
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#understanding-pbasm-compilation" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding PBAsm Compilation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Understanding PBAsm Compilation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#why-pbasm-matters" class="md-nav__link">
    <span class="md-ellipsis">
      Why PBAsm Matters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compilation-example" class="md-nav__link">
    <span class="md-ellipsis">
      Compilation Example
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-pbasm-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      Key PBAsm Concepts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-this-helps-you" class="md-nav__link">
    <span class="md-ellipsis">
      Why This Helps You
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#you-dont-need-to-write-pbasm" class="md-nav__link">
    <span class="md-ellipsis">
      You Don't Need to Write PBAsm
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quick-reference" class="md-nav__link">
    <span class="md-ellipsis">
      Quick Reference
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Quick Reference">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#minimal-working-program" class="md-nav__link">
    <span class="md-ellipsis">
      Minimal Working Program
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#more-complex-example" class="md-nav__link">
    <span class="md-ellipsis">
      More complex example
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cheat-sheet" class="md-nav__link">
    <span class="md-ellipsis">
      Cheat Sheet
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#programming-principles" class="md-nav__link">
    <span class="md-ellipsis">
      Programming Principles
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#for-ai-coding-assistants" class="md-nav__link">
    <span class="md-ellipsis">
      For AI Coding Assistants
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../reference/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Reference
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Configuration System
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Supported Models
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/playbooks-ai/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Playbooks AI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/playbooks-language/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Playbooks Language
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/playbooks-assembly-language/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Playbooks Assembly Language
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Agents
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/mcp-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MCP based Agents
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/exported-and-public-playbooks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Exported and Public Playbooks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/playbook-types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Playbook Types
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/builtin-playbooks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Built-in Playbooks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/triggers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Triggers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/context-engineering/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Context Engineering
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/description-placeholders/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Description Placeholders
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    <span class="md-ellipsis">
      Table of Contents
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#core-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      Core Concepts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Core Concepts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#philosophy-software-30" class="md-nav__link">
    <span class="md-ellipsis">
      Philosophy: Software 3.0
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-abstractions" class="md-nav__link">
    <span class="md-ellipsis">
      Key Abstractions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#language-syntax-and-formatting" class="md-nav__link">
    <span class="md-ellipsis">
      Language Syntax and Formatting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Language Syntax and Formatting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#file-structure" class="md-nav__link">
    <span class="md-ellipsis">
      File Structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formatting-rules" class="md-nav__link">
    <span class="md-ellipsis">
      Formatting Rules
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-five-playbook-types" class="md-nav__link">
    <span class="md-ellipsis">
      The Five Playbook Types
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The Five Playbook Types">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#decision-framework" class="md-nav__link">
    <span class="md-ellipsis">
      Decision Framework
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1-markdown-playbooks-structured-workflows" class="md-nav__link">
    <span class="md-ellipsis">
      1. Markdown Playbooks - Structured Workflows
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-react-playbooks-dynamic-reasoning" class="md-nav__link">
    <span class="md-ellipsis">
      2. ReAct Playbooks - Dynamic Reasoning
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-raw-prompt-playbooks-full-control" class="md-nav__link">
    <span class="md-ellipsis">
      3. Raw Prompt Playbooks - Full Control
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-python-playbooks-hard-logic" class="md-nav__link">
    <span class="md-ellipsis">
      4. Python Playbooks - Hard Logic
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#when-to-extract-python-playbooks-to-mcp-server" class="md-nav__link">
    <span class="md-ellipsis">
      When to Extract Python Playbooks to MCP Server
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-external-playbooks-remote-tools" class="md-nav__link">
    <span class="md-ellipsis">
      5. External Playbooks - Remote Tools
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#decomposing-tasks-into-playbooks" class="md-nav__link">
    <span class="md-ellipsis">
      Decomposing Tasks into Playbooks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Decomposing Tasks into Playbooks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#decomposition-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      Decomposition Strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#granularity-guidelines" class="md-nav__link">
    <span class="md-ellipsis">
      Granularity Guidelines
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#when-to-create-separate-playbooks" class="md-nav__link">
    <span class="md-ellipsis">
      When to Create Separate Playbooks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#natural-language-vs-explicit-syntax" class="md-nav__link">
    <span class="md-ellipsis">
      Natural Language vs Explicit Syntax
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Natural Language vs Explicit Syntax">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-spectrum-of-explicitness" class="md-nav__link">
    <span class="md-ellipsis">
      The Spectrum of Explicitness
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#variable-assignment" class="md-nav__link">
    <span class="md-ellipsis">
      Variable Assignment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#when-to-use-each-style" class="md-nav__link">
    <span class="md-ellipsis">
      When to Use Each Style
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-call-syntax-options" class="md-nav__link">
    <span class="md-ellipsis">
      Function Call Syntax Options
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multi-agent-programs" class="md-nav__link">
    <span class="md-ellipsis">
      Multi-Agent Programs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Multi-Agent Programs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#when-to-use-multiple-agents" class="md-nav__link">
    <span class="md-ellipsis">
      When to Use Multiple Agents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-multiple-agents" class="md-nav__link">
    <span class="md-ellipsis">
      Creating Multiple Agents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agent-communication-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Agent Communication Methods
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Agent Communication Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-direct-public-playbook-calls" class="md-nav__link">
    <span class="md-ellipsis">
      1. Direct Public Playbook Calls
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-natural-language-messaging" class="md-nav__link">
    <span class="md-ellipsis">
      2. Natural Language Messaging
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-meetings-multi-party-coordination" class="md-nav__link">
    <span class="md-ellipsis">
      3. Meetings - Multi-Party Coordination
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multi-agent-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Multi-Agent Best Practices
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#triggers-event-driven-programming" class="md-nav__link">
    <span class="md-ellipsis">
      Triggers: Event-Driven Programming
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Triggers: Event-Driven Programming">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#why-use-triggers" class="md-nav__link">
    <span class="md-ellipsis">
      Why Use Triggers?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#when-to-use-triggers" class="md-nav__link">
    <span class="md-ellipsis">
      When to Use Triggers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-validation-pattern-before-after" class="md-nav__link">
    <span class="md-ellipsis">
      The Validation Pattern: Before &amp; After
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trigger-types" class="md-nav__link">
    <span class="md-ellipsis">
      Trigger Types
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-trigger-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      Common Trigger Patterns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-triggers-simplify-programs" class="md-nav__link">
    <span class="md-ellipsis">
      How Triggers Simplify Programs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trigger-execution-model" class="md-nav__link">
    <span class="md-ellipsis">
      Trigger Execution Model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#when-not-to-use-triggers" class="md-nav__link">
    <span class="md-ellipsis">
      When NOT to Use Triggers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trigger-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Trigger Best Practices
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#description-placeholders" class="md-nav__link">
    <span class="md-ellipsis">
      Description Placeholders
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Description Placeholders">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Basic Usage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-you-can-use" class="md-nav__link">
    <span class="md-ellipsis">
      What You Can Use
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      Common Patterns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Best Practices
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#artifacts-and-memory" class="md-nav__link">
    <span class="md-ellipsis">
      Artifacts and Memory
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Artifacts and Memory">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#artifacts-persistent-files-alpha-feature" class="md-nav__link">
    <span class="md-ellipsis">
      Artifacts - Persistent Files (alpha feature)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#when-to-use-artifacts" class="md-nav__link">
    <span class="md-ellipsis">
      When to Use Artifacts
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common-patterns-and-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Common Patterns and Best Practices
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Common Patterns and Best Practices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pattern-conversational-input-collection" class="md-nav__link">
    <span class="md-ellipsis">
      Pattern: Conversational Input Collection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pattern-validation-with-triggers" class="md-nav__link">
    <span class="md-ellipsis">
      Pattern: Validation with Triggers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pattern-python-markdown-composition" class="md-nav__link">
    <span class="md-ellipsis">
      Pattern: Python ↔ Markdown Composition
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pattern-batch-operations" class="md-nav__link">
    <span class="md-ellipsis">
      Pattern: Batch Operations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pattern-error-handling" class="md-nav__link">
    <span class="md-ellipsis">
      Pattern: Error Handling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pattern-meeting-facilitation" class="md-nav__link">
    <span class="md-ellipsis">
      Pattern: Meeting Facilitation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pattern-collecting-inputs-from-user" class="md-nav__link">
    <span class="md-ellipsis">
      Pattern: Collecting Inputs from User
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pattern-mock-backend-interactions-with-python-playbooks" class="md-nav__link">
    <span class="md-ellipsis">
      Pattern: Mock Backend Interactions with Python Playbooks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#best-practices-summary" class="md-nav__link">
    <span class="md-ellipsis">
      Best Practices Summary
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#editing-existing-programs" class="md-nav__link">
    <span class="md-ellipsis">
      Editing Existing Programs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Editing Existing Programs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#surgical-editing-principles" class="md-nav__link">
    <span class="md-ellipsis">
      Surgical Editing Principles
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-edit-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      Common Edit Patterns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-edit-request" class="md-nav__link">
    <span class="md-ellipsis">
      Example Edit Request
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#understanding-pbasm-compilation" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding PBAsm Compilation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Understanding PBAsm Compilation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#why-pbasm-matters" class="md-nav__link">
    <span class="md-ellipsis">
      Why PBAsm Matters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compilation-example" class="md-nav__link">
    <span class="md-ellipsis">
      Compilation Example
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-pbasm-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      Key PBAsm Concepts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-this-helps-you" class="md-nav__link">
    <span class="md-ellipsis">
      Why This Helps You
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#you-dont-need-to-write-pbasm" class="md-nav__link">
    <span class="md-ellipsis">
      You Don't Need to Write PBAsm
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quick-reference" class="md-nav__link">
    <span class="md-ellipsis">
      Quick Reference
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Quick Reference">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#minimal-working-program" class="md-nav__link">
    <span class="md-ellipsis">
      Minimal Working Program
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#more-complex-example" class="md-nav__link">
    <span class="md-ellipsis">
      More complex example
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cheat-sheet" class="md-nav__link">
    <span class="md-ellipsis">
      Cheat Sheet
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#programming-principles" class="md-nav__link">
    <span class="md-ellipsis">
      Programming Principles
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#for-ai-coding-assistants" class="md-nav__link">
    <span class="md-ellipsis">
      For AI Coding Assistants
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="playbooks-programming-guide">Playbooks Programming Guide<a class="headerlink" href="#playbooks-programming-guide" title="Permanent link">&para;</a></h1>
<p><strong>Purpose</strong>: This document provides comprehensive guidance for writing effective, optimal, and idiomatic Playbooks programs.</p>
<p>Playbooks is a Software 3.0 language where LLMs act as CPUs. Programs are written in natural language with optional Python, compiled to Playbooks Assembly Language (PBAsm), and executed by LLMs. This guide will help you become an expert Playbooks programmer building sophisticated AI agents.</p>
<hr />
<h2 id="table-of-contents">Table of Contents<a class="headerlink" href="#table-of-contents" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#core-concepts">Core Concepts</a></li>
<li><a href="#language-syntax-and-formatting">Language Syntax and Formatting</a></li>
<li><a href="#the-five-playbook-types">The Five Playbook Types</a></li>
<li><a href="#decomposing-tasks-into-playbooks">Decomposing Tasks into Playbooks</a></li>
<li><a href="#natural-language-vs-explicit-syntax">Natural Language vs Explicit Syntax</a></li>
<li><a href="#multi-agent-programs">Multi-Agent Programs</a></li>
<li><a href="#triggers-event-driven-programming">Triggers: Event-Driven Programming</a></li>
<li><a href="#description-placeholders">Description Placeholders</a></li>
<li><a href="#artifacts-and-memory">Artifacts and Memory</a></li>
<li><a href="#common-patterns-and-best-practices">Common Patterns and Best Practices</a></li>
<li><a href="#editing-existing-programs">Editing Existing Programs</a></li>
<li><a href="#understanding-pbasm-compilation">Understanding PBAsm Compilation</a></li>
</ol>
<hr />
<h2 id="core-concepts">Core Concepts<a class="headerlink" href="#core-concepts" title="Permanent link">&para;</a></h2>
<h3 id="philosophy-software-30">Philosophy: Software 3.0<a class="headerlink" href="#philosophy-software-30" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>LLMs as CPUs</strong>: Natural language instructions are the program; the runtime compiles them to PBAsm and executes on LLM</li>
<li><strong>10x less code</strong>: Remove boilerplate; describe behavior at high abstraction level</li>
<li><strong>Soft + Hard logic</strong>: Run soft logic (NL) on LLM, hard logic (Python) on CPU, on same call stack</li>
<li><strong>Verifiable execution</strong>: Programs compile to structured PBAsm for auditing and debugging</li>
<li><strong>First principles thinking</strong>: Remove unnecessary complexity from agent frameworks</li>
</ul>
<h3 id="key-abstractions">Key Abstractions<a class="headerlink" href="#key-abstractions" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Agents</strong> (H1 <code>#</code>) = Classes with state and methods</li>
<li><strong>Playbooks</strong> (H2 <code>##</code> or <code>@playbook</code>) = Methods/functions</li>
<li><strong>Multi-agent communication</strong> = Message passing + direct calls</li>
<li><strong>Triggers</strong> = Event-driven interrupts (like CPU interrupts)</li>
<li><strong>Variables</strong> = Prefixed with <code>$</code>, typed at runtime</li>
</ul>
<hr />
<h2 id="language-syntax-and-formatting">Language Syntax and Formatting<a class="headerlink" href="#language-syntax-and-formatting" title="Permanent link">&para;</a></h2>
<h3 id="file-structure">File Structure<a class="headerlink" href="#file-structure" title="Permanent link">&para;</a></h3>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gh"># AgentName</span>
</span><span id="__codeline__-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>Agent description and personality. Define capabilities and behavioral traits here.
</span><span id="__codeline__-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__codeline__-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gu">## PlaybookName($param1, $param2)</span>
</span><span id="__codeline__-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>Playbook description explaining what it does and when to use it.
</span><span id="__codeline__-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
</span><span id="__codeline__-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gu">### Triggers</span>
</span><span id="__codeline__-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="k">-</span><span class="w"> </span>When to execute this playbook
</span><span id="__codeline__-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>
</span><span id="__codeline__-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="k">-</span><span class="w"> </span>Step 1
</span><span id="__codeline__-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="k">-</span><span class="w"> </span>Step 2
</span><span id="__codeline__-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>
</span><span id="__codeline__-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="gu">### Notes</span>
</span><span id="__codeline__-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="k">-</span><span class="w"> </span>Additional guidance for LLM
</span><span id="__codeline__-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>
</span><span id="__codeline__-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="sb">```python</span>
</span><span id="__codeline__-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="c1"># Python code blocks can appear anywhere</span>
</span><span id="__codeline__-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="nd">@playbook</span>
</span><span id="__codeline__-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="k">async</span> <span class="k">def</span> <span class="nf">PythonPlaybook</span><span class="p">(</span><span class="n">param</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__codeline__-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Docstring becomes playbook description&quot;&quot;&quot;</span>
</span><span id="__codeline__-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>    <span class="k">return</span> <span class="n">result</span>
</span><span id="__codeline__-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="sb">```</span>
</span><span id="__codeline__-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>
</span><span id="__codeline__-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="gh"># SecondAgent</span>
</span><span id="__codeline__-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>Another agent in the same program file
</span></code></pre></div>
<h3 id="formatting-rules">Formatting Rules<a class="headerlink" href="#formatting-rules" title="Permanent link">&para;</a></h3>
<p><strong>H1 Tags (<code>#</code>)</strong> - Agent Definitions
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="gh"># AgentName</span>
</span><span id="__codeline__-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>Description of agent&#39;s purpose and personality
</span></code></pre></div></p>
<p><strong>H2 Tags (<code>##</code>)</strong> - Playbook Definitions
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="gu">## PlaybookName($param1, $param2)</span>
</span></code></pre></div></p>
<p><strong>H3 Tags (<code>###</code>)</strong> - Special Sections
- <code>### Triggers</code> - When playbook executes
- <code>### Steps</code> - Execution instructions (only for Markdown playbooks)
- <code>### Notes</code> - Business rules and guidance</p>
<p><strong>Metadata</strong> - Key-value pairs at start of description
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="gu">## PlaybookName</span>
</span><span id="__codeline__-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>execution_mode: raw
</span><span id="__codeline__-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>public: true
</span><span id="__codeline__-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>meeting: true
</span><span id="__codeline__-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>
</span><span id="__codeline__-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>Description text here
</span></code></pre></div></p>
<p><strong>Variables</strong> - Always prefixed with <code>$</code>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="k">-</span><span class="w"> </span>Ask user for their $name
</span><span id="__codeline__-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="k">-</span><span class="w"> </span>$count = 10
</span><span id="__codeline__-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="k">-</span><span class="w"> </span>$result = GetData($name)
</span></code></pre></div></p>
<p><strong>Type Annotations</strong> - Optional but helpful for clarity
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="k">-</span><span class="w"> </span>Ask user for their $name:str
</span><span id="__codeline__-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="k">-</span><span class="w"> </span>$count:int = 10
</span><span id="__codeline__-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="k">-</span><span class="w"> </span>$results:list = []
</span></code></pre></div></p>
<p><strong>Comments</strong>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>&lt;!-- This is a comment in Playbooks --&gt;
</span></code></pre></div></p>
<hr />
<h2 id="the-five-playbook-types">The Five Playbook Types<a class="headerlink" href="#the-five-playbook-types" title="Permanent link">&para;</a></h2>
<h3 id="decision-framework">Decision Framework<a class="headerlink" href="#decision-framework" title="Permanent link">&para;</a></h3>
<div class="language-text highlight"><pre><span></span><code><span id="__codeline__-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>START: What type of playbook do I need?
</span><span id="__codeline__-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>│
</span><span id="__codeline__-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>├─ Do I need deterministic logic, external APIs, or complex calculations?
</span><span id="__codeline__-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>│  └─ YES → Python Playbook
</span><span id="__codeline__-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>│       └─ Will I have 4+ Python playbooks in this agent and will this Python playbook NOT need to call a Markdown/ReAct/Raw Prompt playbook?
</span><span id="__codeline__-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>│           └─ YES → Extract into MCP Server instead
</span><span id="__codeline__-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>│
</span><span id="__codeline__-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>├─ Do I know the exact steps in advance?
</span><span id="__codeline__-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>│  └─ YES → Markdown Playbook
</span><span id="__codeline__-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a>│
</span><span id="__codeline__-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a>├─ Do steps depend on dynamic research/reasoning?
</span><span id="__codeline__-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a>│  └─ YES → ReAct Playbook
</span><span id="__codeline__-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a>│
</span><span id="__codeline__-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a>├─ Do I need exact prompt control for single-shot task?
</span><span id="__codeline__-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a>│  └─ YES → Raw Prompt Playbook
</span><span id="__codeline__-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a>│
</span><span id="__codeline__-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a>└─ Am I integrating external MCP server tools?
</span><span id="__codeline__-7-18"><a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a>   └─ YES → External Playbook (via MCP agent)
</span></code></pre></div>
<h3 id="1-markdown-playbooks-structured-workflows">1. Markdown Playbooks - Structured Workflows<a class="headerlink" href="#1-markdown-playbooks-structured-workflows" title="Permanent link">&para;</a></h3>
<p><strong>Use when</strong>: Steps are known, process is repeatable, need explicit control flow</p>
<p><strong>Structure</strong>:
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="gu">## PlaybookName($param1, $param2)</span>
</span><span id="__codeline__-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>Description
</span><span id="__codeline__-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>
</span><span id="__codeline__-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="gu">### Triggers</span>
</span><span id="__codeline__-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="k">-</span><span class="w"> </span>When condition is met
</span><span id="__codeline__-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>
</span><span id="__codeline__-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="k">-</span><span class="w"> </span>Step with natural language instruction
</span><span id="__codeline__-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="k">-</span><span class="w"> </span>$variable = Assign from another step
</span><span id="__codeline__-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="k">-</span><span class="w"> </span>If condition
</span><span id="__codeline__-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Nested step
</span><span id="__codeline__-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>While another condition
</span><span id="__codeline__-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a><span class="w">    </span><span class="k">-</span><span class="w"> </span>Deeply nested step
</span><span id="__codeline__-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a><span class="k">-</span><span class="w"> </span>Otherwise
</span><span id="__codeline__-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Alternative path
</span><span id="__codeline__-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a><span class="k">-</span><span class="w"> </span>Return result
</span><span id="__codeline__-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a>
</span><span id="__codeline__-8-18"><a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a><span class="gu">### Notes</span>
</span><span id="__codeline__-8-19"><a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a><span class="k">-</span><span class="w"> </span>Business rules that apply throughout execution
</span></code></pre></div></p>
<p><strong>Example</strong>:
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="gu">## ProcessOrder($order_id)</span>
</span><span id="__codeline__-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>Process a customer order from validation through fulfillment
</span><span id="__codeline__-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>
</span><span id="__codeline__-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="k">-</span><span class="w"> </span>Get $order from database using $order_id
</span><span id="__codeline__-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="k">-</span><span class="w"> </span>If $order was not found
</span><span id="__codeline__-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Tell user order not found
</span><span id="__codeline__-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Return error
</span><span id="__codeline__-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="k">-</span><span class="w"> </span>Validate payment for $order
</span><span id="__codeline__-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="k">-</span><span class="w"> </span>If payment is valid
</span><span id="__codeline__-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Update order status to processing
</span><span id="__codeline__-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Send confirmation email to customer
</span><span id="__codeline__-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Return success
</span><span id="__codeline__-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a><span class="k">-</span><span class="w"> </span>Otherwise
</span><span id="__codeline__-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Tell user payment failed
</span><span id="__codeline__-9-16"><a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Return payment error
</span></code></pre></div></p>
<p><strong>Control Flow</strong>:
- Sequential: Just list steps in order
- Conditional: <code>If condition</code>, <code>Otherwise</code>, <code>Else if condition</code>
- Loops: <code>While condition</code>, <code>For each $item in $list</code>
- Variable assignment: <code>$var = value</code> or <code>Get $var from source</code>
- Return: <code>Return value</code> or <code>Return $variable</code>
- End program: <code>End program</code> (terminates execution)</p>
<h3 id="2-react-playbooks-dynamic-reasoning">2. ReAct Playbooks - Dynamic Reasoning<a class="headerlink" href="#2-react-playbooks-dynamic-reasoning" title="Permanent link">&para;</a></h3>
<p><strong>Use when</strong>: Steps can't be predetermined, need research, adaptive behavior</p>
<p><strong>Structure</strong>:
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="gu">## PlaybookName($param)</span>
</span><span id="__codeline__-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>execution_mode: react  # Optional - inferred if no Steps section
</span><span id="__codeline__-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>
</span><span id="__codeline__-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>Detailed description of task, goals, constraints, and expected output.
</span><span id="__codeline__-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>
</span><span id="__codeline__-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>&lt;planning_rules&gt;
</span><span id="__codeline__-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="k">-</span><span class="w"> </span>Rule 1 for how to approach the task
</span><span id="__codeline__-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="k">-</span><span class="w"> </span>Rule 2 for verification
</span><span id="__codeline__-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a>&lt;/planning_rules&gt;
</span><span id="__codeline__-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a>
</span><span id="__codeline__-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a>&lt;style_guide&gt;
</span><span id="__codeline__-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="k">-</span><span class="w"> </span>Tone and communication style
</span><span id="__codeline__-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="k">-</span><span class="w"> </span>Formatting preferences
</span><span id="__codeline__-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a>&lt;/style_guide&gt;
</span><span id="__codeline__-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a>
</span><span id="__codeline__-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a>&lt;output_format&gt;
</span><span id="__codeline__-10-17"><a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a>Expected structure of final output
</span><span id="__codeline__-10-18"><a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a>&lt;/output_format&gt;
</span><span id="__codeline__-10-19"><a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a>
</span><span id="__codeline__-10-20"><a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a><span class="gu">### Triggers</span>
</span><span id="__codeline__-10-21"><a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a><span class="k">-</span><span class="w"> </span>When to execute
</span></code></pre></div></p>
<p><strong>Key Points</strong>:
- No <code>### Steps</code> section
- Framework provides default think-plan-act loop
- All playbooks available as tools
- LLM decides what actions to take</p>
<p><strong>Example</strong>:
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="gu">## ResearchCompany($company_name)</span>
</span><span id="__codeline__-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>Conduct comprehensive competitive analysis with market positioning,
</span><span id="__codeline__-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>products, pricing, and recent developments.
</span><span id="__codeline__-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>
</span><span id="__codeline__-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>&lt;planning_rules&gt;
</span><span id="__codeline__-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="k">-</span><span class="w"> </span>Start by identifying primary products and services
</span><span id="__codeline__-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="k">-</span><span class="w"> </span>Search for recent news and financials (last 6 months)
</span><span id="__codeline__-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="k">-</span><span class="w"> </span>Verify information across multiple sources
</span><span id="__codeline__-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="k">-</span><span class="w"> </span>Compare with top 3 competitors
</span><span id="__codeline__-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a>&lt;/planning_rules&gt;
</span><span id="__codeline__-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a>
</span><span id="__codeline__-11-12"><a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a>&lt;output_format&gt;
</span><span id="__codeline__-11-13"><a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a><span class="gh"># Company Analysis: [Name]</span>
</span><span id="__codeline__-11-14"><a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a><span class="gu">## Overview</span>
</span><span id="__codeline__-11-15"><a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a><span class="gu">## Products</span>
</span><span id="__codeline__-11-16"><a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a><span class="gu">## Market Position</span>
</span><span id="__codeline__-11-17"><a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a><span class="gu">## Recent Developments</span>
</span><span id="__codeline__-11-18"><a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a><span class="gu">## Conclusion</span>
</span><span id="__codeline__-11-19"><a id="__codelineno-11-19" name="__codelineno-11-19" href="#__codelineno-11-19"></a>&lt;/output_format&gt;
</span></code></pre></div></p>
<h3 id="3-raw-prompt-playbooks-full-control">3. Raw Prompt Playbooks - Full Control<a class="headerlink" href="#3-raw-prompt-playbooks-full-control" title="Permanent link">&para;</a></h3>
<p><strong>Use when</strong>: Need exact prompt control, single-shot tasks, minimal overhead</p>
<p><strong>Structure</strong>:
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="gu">## PlaybookName</span>
</span><span id="__codeline__-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>execution_mode: raw
</span><span id="__codeline__-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>
</span><span id="__codeline__-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>Exact prompt text. This goes directly to LLM.
</span><span id="__codeline__-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>Use {$variable} and {PlaybookCall()} for dynamic content.
</span></code></pre></div></p>
<p><strong>Key Points</strong>:
- Single LLM call, no loops
- Cannot call other playbooks during execution
- No automatic context management
- Use for classification, extraction, formatting</p>
<p><strong>Example</strong>:
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="gu">## CategorizeTicket</span>
</span><span id="__codeline__-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>execution_mode: raw
</span><span id="__codeline__-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>
</span><span id="__codeline__-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>Categorize this support ticket: {$ticket_message}
</span><span id="__codeline__-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>
</span><span id="__codeline__-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>Categories:
</span><span id="__codeline__-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="k">-</span><span class="w"> </span>Technical Support
</span><span id="__codeline__-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="k">-</span><span class="w"> </span>Billing  
</span><span id="__codeline__-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="k">-</span><span class="w"> </span>Account Management
</span><span id="__codeline__-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a><span class="k">-</span><span class="w"> </span>General Inquiry
</span><span id="__codeline__-13-11"><a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a>
</span><span id="__codeline__-13-12"><a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a>Respond with ONLY the category name.
</span><span id="__codeline__-13-13"><a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a>Category:
</span></code></pre></div></p>
<h3 id="4-python-playbooks-hard-logic">4. Python Playbooks - Hard Logic<a class="headerlink" href="#4-python-playbooks-hard-logic" title="Permanent link">&para;</a></h3>
<p><strong>Use when</strong>: Need deterministic logic, external APIs, complex calculations</p>
<p><strong>Structure</strong>:
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="sb">```python</span>
</span><span id="__codeline__-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span>
</span><span id="__codeline__-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>
</span><span id="__codeline__-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="nd">@playbook</span>
</span><span id="__codeline__-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="k">async</span> <span class="k">def</span> <span class="nf">PlaybookName</span><span class="p">(</span><span class="n">param1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">param2</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="__codeline__-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__codeline__-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="sd">    Docstring becomes playbook description.</span>
</span><span id="__codeline__-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a>
</span><span id="__codeline__-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="sd">    Args:</span>
</span><span id="__codeline__-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a><span class="sd">        param1: Description</span>
</span><span id="__codeline__-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="sd">        param2: Description</span>
</span><span id="__codeline__-14-12"><a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a>
</span><span id="__codeline__-14-13"><a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a><span class="sd">    Returns:</span>
</span><span id="__codeline__-14-14"><a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a><span class="sd">        Description</span>
</span><span id="__codeline__-14-15"><a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__codeline__-14-16"><a id="__codelineno-14-16" name="__codelineno-14-16" href="#__codelineno-14-16"></a>    <span class="c1"># Your Python code</span>
</span><span id="__codeline__-14-17"><a id="__codelineno-14-17" name="__codelineno-14-17" href="#__codelineno-14-17"></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">compute</span><span class="p">(</span><span class="n">param1</span><span class="p">,</span> <span class="n">param2</span><span class="p">)</span>
</span><span id="__codeline__-14-18"><a id="__codelineno-14-18" name="__codelineno-14-18" href="#__codelineno-14-18"></a>
</span><span id="__codeline__-14-19"><a id="__codelineno-14-19" name="__codelineno-14-19" href="#__codelineno-14-19"></a>    <span class="c1"># Can call other playbooks (Markdown or Python)</span>
</span><span id="__codeline__-14-20"><a id="__codelineno-14-20" name="__codelineno-14-20" href="#__codelineno-14-20"></a>    <span class="n">summary</span> <span class="o">=</span> <span class="k">await</span> <span class="n">SummarizeResult</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="__codeline__-14-21"><a id="__codelineno-14-21" name="__codelineno-14-21" href="#__codelineno-14-21"></a>
</span><span id="__codeline__-14-22"><a id="__codelineno-14-22" name="__codelineno-14-22" href="#__codelineno-14-22"></a>    <span class="k">return</span> <span class="n">summary</span>
</span><span id="__codeline__-14-23"><a id="__codelineno-14-23" name="__codelineno-14-23" href="#__codelineno-14-23"></a>
</span><span id="__codeline__-14-24"><a id="__codelineno-14-24" name="__codelineno-14-24" href="#__codelineno-14-24"></a><span class="nd">@playbook</span><span class="p">(</span><span class="n">triggers</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;When user provides PIN&quot;</span><span class="p">],</span> <span class="n">public</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__codeline__-14-25"><a id="__codelineno-14-25" name="__codelineno-14-25" href="#__codelineno-14-25"></a><span class="k">async</span> <span class="k">def</span> <span class="nf">ValidatePIN</span><span class="p">(</span><span class="n">pin</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__codeline__-14-26"><a id="__codelineno-14-26" name="__codelineno-14-26" href="#__codelineno-14-26"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate PIN format and check database.&quot;&quot;&quot;</span>
</span><span id="__codeline__-14-27"><a id="__codelineno-14-27" name="__codelineno-14-27" href="#__codelineno-14-27"></a>    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">pin</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span> <span class="ow">and</span> <span class="n">pin</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span>
</span><span id="__codeline__-14-28"><a id="__codelineno-14-28" name="__codelineno-14-28" href="#__codelineno-14-28"></a><span class="sb">```</span>
</span></code></pre></div></p>
<p><strong>Decorator Options</strong>:
- <code>@playbook</code> - Basic playbook
- <code>@playbook(public=True)</code> - Callable by other agents
- <code>@playbook(export=True)</code> - Allow implementation export
- <code>@playbook(triggers=["condition"])</code> - Add triggers
- <code>@playbook(metadata={...})</code> - Custom metadata</p>
<p><strong>Key Points</strong>:
- Full Python power: any library, complex logic, external APIs
- Use <code>await</code> to call other playbooks
- Return user-readable strings/dicts when called from Markdown
- Can call Markdown playbooks: <code>await MarkdownPlaybook(args)</code></p>
<h3 id="when-to-extract-python-playbooks-to-mcp-server">When to Extract Python Playbooks to MCP Server<a class="headerlink" href="#when-to-extract-python-playbooks-to-mcp-server" title="Permanent link">&para;</a></h3>
<p>⚠️ <strong>Important Rule</strong>: If you have <strong>more than 3 Python playbooks</strong> in a single agent, extract them to a separate MCP server instead.</p>
<p><strong>Why Extract to MCP</strong>:
- Keeps agent code focused on behavior, not implementation
- Python tools can be reused across multiple agents
- Better separation of concerns
- Easier testing and maintenance
- Can be developed and deployed independently</p>
<p><strong>How to Extract</strong>:</p>
<ol>
<li><strong>Create MCP server file</strong> (e.g., <code>mcp.py</code>):</li>
</ol>
<div class="language-python highlight"><pre><span></span><code><span id="__codeline__-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="kn">from</span> <span class="nn">fastmcp</span> <span class="kn">import</span> <span class="n">FastMCP</span>
</span><span id="__codeline__-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>
</span><span id="__codeline__-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="n">mcp</span> <span class="o">=</span> <span class="n">FastMCP</span><span class="p">(</span><span class="s2">&quot;My Tools Server&quot;</span><span class="p">)</span>
</span><span id="__codeline__-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>
</span><span id="__codeline__-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span>
</span><span id="__codeline__-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="k">def</span> <span class="nf">GetUserInfo</span><span class="p">():</span>
</span><span id="__codeline__-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__codeline__-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="sd">    Get information about the user.</span>
</span><span id="__codeline__-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a>
</span><span id="__codeline__-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a><span class="sd">    Returns:</span>
</span><span id="__codeline__-15-11"><a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a><span class="sd">        A dictionary containing user information.</span>
</span><span id="__codeline__-15-12"><a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__codeline__-15-13"><a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a>    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;John&quot;</span><span class="p">,</span> <span class="s2">&quot;email&quot;</span><span class="p">:</span> <span class="s2">&quot;john@example.com&quot;</span><span class="p">}</span>
</span><span id="__codeline__-15-14"><a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a>
</span><span id="__codeline__-15-15"><a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a><span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span>
</span><span id="__codeline__-15-16"><a id="__codelineno-15-16" name="__codelineno-15-16" href="#__codelineno-15-16"></a><span class="k">def</span> <span class="nf">CalculateSleepEfficiency</span><span class="p">(</span><span class="n">time_in_bed</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">time_asleep</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="__codeline__-15-17"><a id="__codelineno-15-17" name="__codelineno-15-17" href="#__codelineno-15-17"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__codeline__-15-18"><a id="__codelineno-15-18" name="__codelineno-15-18" href="#__codelineno-15-18"></a><span class="sd">    Calculate sleep efficiency percentage.</span>
</span><span id="__codeline__-15-19"><a id="__codelineno-15-19" name="__codelineno-15-19" href="#__codelineno-15-19"></a>
</span><span id="__codeline__-15-20"><a id="__codelineno-15-20" name="__codelineno-15-20" href="#__codelineno-15-20"></a><span class="sd">    Args:</span>
</span><span id="__codeline__-15-21"><a id="__codelineno-15-21" name="__codelineno-15-21" href="#__codelineno-15-21"></a><span class="sd">        time_in_bed: Total minutes in bed</span>
</span><span id="__codeline__-15-22"><a id="__codelineno-15-22" name="__codelineno-15-22" href="#__codelineno-15-22"></a><span class="sd">        time_asleep: Total minutes asleep</span>
</span><span id="__codeline__-15-23"><a id="__codelineno-15-23" name="__codelineno-15-23" href="#__codelineno-15-23"></a>
</span><span id="__codeline__-15-24"><a id="__codelineno-15-24" name="__codelineno-15-24" href="#__codelineno-15-24"></a><span class="sd">    Returns:</span>
</span><span id="__codeline__-15-25"><a id="__codelineno-15-25" name="__codelineno-15-25" href="#__codelineno-15-25"></a><span class="sd">        Sleep efficiency as percentage</span>
</span><span id="__codeline__-15-26"><a id="__codelineno-15-26" name="__codelineno-15-26" href="#__codelineno-15-26"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__codeline__-15-27"><a id="__codelineno-15-27" name="__codelineno-15-27" href="#__codelineno-15-27"></a>    <span class="k">return</span> <span class="nb">round</span><span class="p">((</span><span class="n">time_asleep</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="o">/</span> <span class="n">time_in_bed</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__codeline__-15-28"><a id="__codelineno-15-28" name="__codelineno-15-28" href="#__codelineno-15-28"></a>
</span><span id="__codeline__-15-29"><a id="__codelineno-15-29" name="__codelineno-15-29" href="#__codelineno-15-29"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__codeline__-15-30"><a id="__codelineno-15-30" name="__codelineno-15-30" href="#__codelineno-15-30"></a>    <span class="n">mcp</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">transport</span><span class="o">=</span><span class="s2">&quot;streamable-http&quot;</span><span class="p">)</span>
</span></code></pre></div>
<ol>
<li><strong>Run the MCP server</strong>:</li>
</ol>
<div class="language-bash highlight"><pre><span></span><code><span id="__codeline__-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>fastmcp<span class="w"> </span>run<span class="w"> </span>mcp.py<span class="w"> </span>-t<span class="w"> </span>streamable-http<span class="w"> </span>--port<span class="w"> </span><span class="m">8888</span>
</span></code></pre></div>
<ol>
<li><strong>Define MCP agent in your Playbooks program</strong>:</li>
</ol>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="gh"># ToolsAgent</span>
</span><span id="__codeline__-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>This agent provides various Python tools.
</span><span id="__codeline__-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>remote:
</span><span id="__codeline__-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>  type: mcp
</span><span id="__codeline__-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>  url: http://127.0.0.1:8888/mcp
</span><span id="__codeline__-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>  transport: streamable-http
</span><span id="__codeline__-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a>
</span><span id="__codeline__-17-8"><a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a><span class="gh"># MainAgent</span>
</span><span id="__codeline__-17-9"><a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a>Your main agent description.
</span><span id="__codeline__-17-10"><a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a>
</span><span id="__codeline__-17-11"><a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a><span class="gu">## Main</span>
</span><span id="__codeline__-17-12"><a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-17-13"><a id="__codelineno-17-13" name="__codelineno-17-13" href="#__codelineno-17-13"></a><span class="k">-</span><span class="w"> </span>Load user info from ToolsAgent
</span><span id="__codeline__-17-14"><a id="__codelineno-17-14" name="__codelineno-17-14" href="#__codelineno-17-14"></a><span class="k">-</span><span class="w"> </span>Calculate sleep efficiency using ToolsAgent
</span><span id="__codeline__-17-15"><a id="__codelineno-17-15" name="__codelineno-17-15" href="#__codelineno-17-15"></a><span class="k">-</span><span class="w"> </span>Tell user their sleep efficiency
</span></code></pre></div>
<p><strong>Example from insomnia.pb</strong>:</p>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="gh"># MCP</span>
</span><span id="__codeline__-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>This agent provides various python tools that the sleep coach will use.
</span><span id="__codeline__-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>remote:
</span><span id="__codeline__-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>  type: mcp
</span><span id="__codeline__-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>  url: http://127.0.0.1:8888/mcp
</span><span id="__codeline__-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>  transport: streamable-http
</span><span id="__codeline__-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a>
</span><span id="__codeline__-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a><span class="gh"># Sleep Coach</span>
</span><span id="__codeline__-18-9"><a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a>You are a sleep coach helping users improve their sleep.
</span><span id="__codeline__-18-10"><a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a>
</span><span id="__codeline__-18-11"><a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a><span class="gu">## Main</span>
</span><span id="__codeline__-18-12"><a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-18-13"><a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a><span class="k">-</span><span class="w"> </span>Load user info from MCP
</span><span id="__codeline__-18-14"><a id="__codelineno-18-14" name="__codelineno-18-14" href="#__codelineno-18-14"></a><span class="k">-</span><span class="w"> </span>Get user&#39;s sleep efficiency from MCP
</span><span id="__codeline__-18-15"><a id="__codelineno-18-15" name="__codelineno-18-15" href="#__codelineno-18-15"></a><span class="k">-</span><span class="w"> </span>Welcome user and use the info to help them
</span></code></pre></div>
<p><strong>When NOT to extract</strong>:</p>
<ul>
<li>✅ 1-3 Python playbooks that are tightly coupled to agent logic</li>
<li>✅ Python playbooks that call Markdown playbooks (requires <code>@playbook</code>)</li>
<li>✅ Python playbooks with triggers (requires <code>@playbook</code>)</li>
</ul>
<p><strong>When to extract</strong>:</p>
<ul>
<li>✅ 4+ Python playbooks in single agent</li>
<li>✅ Pure utility functions (calculations, API calls, data transformations)</li>
<li>✅ Tools that could be reused by multiple agents</li>
<li>✅ Complex Python logic that benefits from separate testing</li>
</ul>
<h3 id="5-external-playbooks-remote-tools">5. External Playbooks - Remote Tools<a class="headerlink" href="#5-external-playbooks-remote-tools" title="Permanent link">&para;</a></h3>
<p><strong>Use when</strong>: Integrating MCP servers, external APIs (roadmap)</p>
<p><strong>Structure</strong>:
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="gh"># MCPAgent</span>
</span><span id="__codeline__-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>remote:
</span><span id="__codeline__-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>  type: mcp
</span><span id="__codeline__-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>  transport: streamable-http
</span><span id="__codeline__-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>  url: http://localhost:8000/mcp
</span><span id="__codeline__-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>
</span><span id="__codeline__-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="gh"># LocalAgent</span>
</span><span id="__codeline__-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="gu">## Main</span>
</span><span id="__codeline__-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a><span class="k">-</span><span class="w"> </span>$weather = MCPAgent.get_weather(zipcode=98053)
</span><span id="__codeline__-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a><span class="k">-</span><span class="w"> </span>Tell user the $weather
</span></code></pre></div></p>
<p><strong>Key Points</strong>:
- MCP server tools automatically become playbooks
- Call like any other playbook
- Framework handles transport and auth</p>
<hr />
<h2 id="decomposing-tasks-into-playbooks">Decomposing Tasks into Playbooks<a class="headerlink" href="#decomposing-tasks-into-playbooks" title="Permanent link">&para;</a></h2>
<h3 id="decomposition-strategy">Decomposition Strategy<a class="headerlink" href="#decomposition-strategy" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Identify distinct concerns</strong>: What are the separable responsibilities?</li>
<li><strong>Look for reusability</strong>: What might be called multiple times?</li>
<li><strong>Consider testing</strong>: What would you want to test independently?</li>
<li><strong>Find boundaries</strong>: Where do soft/hard logic boundaries exist?</li>
<li><strong>Separate I/O from logic</strong>: User interaction vs computation</li>
</ol>
<h3 id="granularity-guidelines">Granularity Guidelines<a class="headerlink" href="#granularity-guidelines" title="Permanent link">&para;</a></h3>
<p><strong>Too Fine-Grained</strong> ❌
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="gu">## AskName</span>
</span><span id="__codeline__-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="k">-</span><span class="w"> </span>Ask user for name
</span><span id="__codeline__-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a>
</span><span id="__codeline__-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="gu">## ThankUser($name)</span>
</span><span id="__codeline__-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="k">-</span><span class="w"> </span>Thank $name
</span><span id="__codeline__-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a>
</span><span id="__codeline__-20-9"><a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a><span class="gu">## Main</span>
</span><span id="__codeline__-20-10"><a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-20-11"><a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a><span class="k">-</span><span class="w"> </span>Ask user for name
</span><span id="__codeline__-20-12"><a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a><span class="k">-</span><span class="w"> </span>Thank the user
</span></code></pre></div></p>
<p><strong>Appropriate</strong> ✅
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="gu">## Main</span>
</span><span id="__codeline__-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="k">-</span><span class="w"> </span>Ask user for their $name
</span><span id="__codeline__-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="k">-</span><span class="w"> </span>Thank $name for providing their name
</span></code></pre></div></p>
<p><strong>Too Coarse</strong> ❌
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="gu">## ProcessEverything</span>
</span><span id="__codeline__-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="k">-</span><span class="w"> </span>Get user info
</span><span id="__codeline__-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="k">-</span><span class="w"> </span>Validate info
</span><span id="__codeline__-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="k">-</span><span class="w"> </span>Process payment
</span><span id="__codeline__-22-6"><a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a><span class="k">-</span><span class="w"> </span>Send confirmation
</span><span id="__codeline__-22-7"><a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a><span class="k">-</span><span class="w"> </span>Update inventory
</span><span id="__codeline__-22-8"><a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a><span class="k">-</span><span class="w"> </span>Generate report
</span><span id="__codeline__-22-9"><a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a><span class="k">-</span><span class="w"> </span>Send to accounting
</span><span id="__codeline__-22-10"><a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a><span class="k">-</span><span class="w"> </span>Archive transaction
</span></code></pre></div></p>
<p><strong>Better</strong> ✅
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="gu">## ProcessOrder</span>
</span><span id="__codeline__-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="k">-</span><span class="w"> </span>Collect user info
</span><span id="__codeline__-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="k">-</span><span class="w"> </span>Process payment
</span><span id="__codeline__-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="k">-</span><span class="w"> </span>Fulfill order
</span><span id="__codeline__-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="k">-</span><span class="w"> </span>Notify stakeholders
</span><span id="__codeline__-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a>
</span><span id="__codeline__-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="gu">## CollectUserInfo</span>
</span><span id="__codeline__-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a><span class="k">-</span><span class="w"> </span>Ask for $name, $email, $address; validate all fields; continue engaging with the user till all fields are valid or user wants to give up
</span><span id="__codeline__-23-11"><a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a><span class="k">-</span><span class="w"> </span>Return collected info as a dictionary
</span><span id="__codeline__-23-12"><a id="__codelineno-23-12" name="__codelineno-23-12" href="#__codelineno-23-12"></a>
</span><span id="__codeline__-23-13"><a id="__codelineno-23-13" name="__codelineno-23-13" href="#__codelineno-23-13"></a><span class="gu">## ProcessPayment($user_info)</span>
</span><span id="__codeline__-23-14"><a id="__codelineno-23-14" name="__codelineno-23-14" href="#__codelineno-23-14"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-23-15"><a id="__codelineno-23-15" name="__codelineno-23-15" href="#__codelineno-23-15"></a><span class="k">-</span><span class="w"> </span>Calculate $amount
</span><span id="__codeline__-23-16"><a id="__codelineno-23-16" name="__codelineno-23-16" href="#__codelineno-23-16"></a><span class="k">-</span><span class="w"> </span>Charge payment method
</span><span id="__codeline__-23-17"><a id="__codelineno-23-17" name="__codelineno-23-17" href="#__codelineno-23-17"></a><span class="k">-</span><span class="w"> </span>Return payment record
</span><span id="__codeline__-23-18"><a id="__codelineno-23-18" name="__codelineno-23-18" href="#__codelineno-23-18"></a>
</span><span id="__codeline__-23-19"><a id="__codelineno-23-19" name="__codelineno-23-19" href="#__codelineno-23-19"></a><span class="gu">## FulfillOrder($payment)</span>
</span><span id="__codeline__-23-20"><a id="__codelineno-23-20" name="__codelineno-23-20" href="#__codelineno-23-20"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-23-21"><a id="__codelineno-23-21" name="__codelineno-23-21" href="#__codelineno-23-21"></a><span class="k">-</span><span class="w"> </span>Update inventory
</span><span id="__codeline__-23-22"><a id="__codelineno-23-22" name="__codelineno-23-22" href="#__codelineno-23-22"></a><span class="k">-</span><span class="w"> </span>Generate shipping label
</span><span id="__codeline__-23-23"><a id="__codelineno-23-23" name="__codelineno-23-23" href="#__codelineno-23-23"></a><span class="k">-</span><span class="w"> </span>Send confirmation email
</span><span id="__codeline__-23-24"><a id="__codelineno-23-24" name="__codelineno-23-24" href="#__codelineno-23-24"></a>
</span><span id="__codeline__-23-25"><a id="__codelineno-23-25" name="__codelineno-23-25" href="#__codelineno-23-25"></a><span class="gu">## NotifyStakeholders($payment)</span>
</span><span id="__codeline__-23-26"><a id="__codelineno-23-26" name="__codelineno-23-26" href="#__codelineno-23-26"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-23-27"><a id="__codelineno-23-27" name="__codelineno-23-27" href="#__codelineno-23-27"></a><span class="k">-</span><span class="w"> </span>Send to accounting system
</span><span id="__codeline__-23-28"><a id="__codelineno-23-28" name="__codelineno-23-28" href="#__codelineno-23-28"></a><span class="k">-</span><span class="w"> </span>Archive transaction
</span><span id="__codeline__-23-29"><a id="__codelineno-23-29" name="__codelineno-23-29" href="#__codelineno-23-29"></a><span class="k">-</span><span class="w"> </span>Update analytics
</span></code></pre></div></p>
<h3 id="when-to-create-separate-playbooks">When to Create Separate Playbooks<a class="headerlink" href="#when-to-create-separate-playbooks" title="Permanent link">&para;</a></h3>
<p><strong>Create separate playbook when</strong>:</p>
<ul>
<li>✅ Logic might be reused elsewhere</li>
<li>✅ Has clear single responsibility</li>
<li>✅ Could be triggered independently</li>
<li>✅ Needs Python for deterministic logic</li>
<li>✅ Represents distinct business process</li>
<li>✅ Makes main flow more readable</li>
</ul>
<p><strong>Keep inline when</strong>:</p>
<ul>
<li>✅ Used only once</li>
<li>✅ Tightly coupled to parent context</li>
<li>✅ Simple, linear flow</li>
<li>✅ Would hurt readability to separate</li>
</ul>
<hr />
<h2 id="natural-language-vs-explicit-syntax">Natural Language vs Explicit Syntax<a class="headerlink" href="#natural-language-vs-explicit-syntax" title="Permanent link">&para;</a></h2>
<h3 id="the-spectrum-of-explicitness">The Spectrum of Explicitness<a class="headerlink" href="#the-spectrum-of-explicitness" title="Permanent link">&para;</a></h3>
<p>Playbooks supports a spectrum from pure natural language to Python-like explicit syntax. <strong>Prefer natural language</strong> unless explicitness aids clarity or correctness.</p>
<h3 id="variable-assignment">Variable Assignment<a class="headerlink" href="#variable-assignment" title="Permanent link">&para;</a></h3>
<p><strong>Natural Language</strong> (Preferred):
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="k">-</span><span class="w"> </span>Ask user for their order id
</span><span id="__codeline__-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="k">-</span><span class="w"> </span>Get order details from database
</span><span id="__codeline__-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="k">-</span><span class="w"> </span>Calculate shipping cost
</span></code></pre></div></p>
<p><strong>Semi-Explicit</strong>:
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="k">-</span><span class="w"> </span>Ask user for their $order_id
</span><span id="__codeline__-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="k">-</span><span class="w"> </span>Get $order_details from database
</span><span id="__codeline__-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="k">-</span><span class="w"> </span>Calculate $shipping_cost based on $order_details
</span></code></pre></div></p>
<p><strong>Fully Explicit</strong>:
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="k">-</span><span class="w"> </span>$order_id = AskForOrderId()
</span><span id="__codeline__-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="k">-</span><span class="w"> </span>$order_details = GetOrderDetails($order_id)
</span><span id="__codeline__-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="k">-</span><span class="w"> </span>$shipping_cost = CalculateShipping($order_details.weight, $order_details.destination)
</span></code></pre></div></p>
<h3 id="when-to-use-each-style">When to Use Each Style<a class="headerlink" href="#when-to-use-each-style" title="Permanent link">&para;</a></h3>
<p><strong>Pure Natural Language</strong>:
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="k">-</span><span class="w"> </span>Greet user and ask what they need help with
</span><span id="__codeline__-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="k">-</span><span class="w"> </span>Find the most relevant article for their question
</span><span id="__codeline__-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="k">-</span><span class="w"> </span>Share the article with friendly explanation
</span></code></pre></div></p>
<ul>
<li>✅ Clear intent</li>
<li>✅ One-time flow</li>
<li>✅ No complex data passing</li>
</ul>
<p><strong>Variable Names</strong> (add clarity):
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="k">-</span><span class="w"> </span>Ask user for their $email and $password
</span><span id="__codeline__-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="k">-</span><span class="w"> </span>Validate $email format
</span><span id="__codeline__-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="k">-</span><span class="w"> </span>If $email is invalid
</span><span id="__codeline__-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Tell user $email is not valid
</span></code></pre></div></p>
<ul>
<li>✅ Value used multiple times</li>
<li>✅ The variable should become part of the agent's state</li>
<li>✅ Type helps LLM understand</li>
</ul>
<p><strong>Explicit Calls</strong> (precision needed):
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="k">-</span><span class="w"> </span>$temp_c = ConvertToCelsius($temp_f)
</span><span id="__codeline__-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="k">-</span><span class="w"> </span>$weather = WeatherAgent.GetForecast(zipcode=$zipcode, units=&quot;metric&quot;)
</span><span id="__codeline__-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a><span class="k">-</span><span class="w"> </span>$summary = FormatWeather($weather, temperature=$temp_c)
</span></code></pre></div></p>
<ul>
<li>✅ Exact parameters matter</li>
<li>✅ Cross-agent calls</li>
<li>✅ Return value used in computation</li>
</ul>
<h3 id="function-call-syntax-options">Function Call Syntax Options<a class="headerlink" href="#function-call-syntax-options" title="Permanent link">&para;</a></h3>
<p>All of these are valid:</p>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="gh"># Most natural</span>
</span><span id="__codeline__-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="k">-</span><span class="w"> </span>Get order status
</span><span id="__codeline__-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a>
</span><span id="__codeline__-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a><span class="gh"># With variable</span>
</span><span id="__codeline__-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a><span class="k">-</span><span class="w"> </span>Get $order_status
</span><span id="__codeline__-30-6"><a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a>
</span><span id="__codeline__-30-7"><a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a><span class="gh"># Explicit call, implicit args</span>
</span><span id="__codeline__-30-8"><a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a><span class="k">-</span><span class="w"> </span>GetOrderStatus($order_id)
</span><span id="__codeline__-30-9"><a id="__codelineno-30-9" name="__codelineno-30-9" href="#__codelineno-30-9"></a>
</span><span id="__codeline__-30-10"><a id="__codelineno-30-10" name="__codelineno-30-10" href="#__codelineno-30-10"></a><span class="gh"># Explicit call with named args</span>
</span><span id="__codeline__-30-11"><a id="__codelineno-30-11" name="__codelineno-30-11" href="#__codelineno-30-11"></a><span class="k">-</span><span class="w"> </span>$status = GetOrderStatus(order_id=$order_id)
</span><span id="__codeline__-30-12"><a id="__codelineno-30-12" name="__codelineno-30-12" href="#__codelineno-30-12"></a>
</span><span id="__codeline__-30-13"><a id="__codelineno-30-13" name="__codelineno-30-13" href="#__codelineno-30-13"></a><span class="gh"># Cross-agent call</span>
</span><span id="__codeline__-30-14"><a id="__codelineno-30-14" name="__codelineno-30-14" href="#__codelineno-30-14"></a><span class="k">-</span><span class="w"> </span>$status = OrderService.GetOrderStatus(order_id=$order_id)
</span><span id="__codeline__-30-15"><a id="__codelineno-30-15" name="__codelineno-30-15" href="#__codelineno-30-15"></a>
</span><span id="__codeline__-30-16"><a id="__codelineno-30-16" name="__codelineno-30-16" href="#__codelineno-30-16"></a><span class="gh"># Natural language with explicit args</span>
</span><span id="__codeline__-30-17"><a id="__codelineno-30-17" name="__codelineno-30-17" href="#__codelineno-30-17"></a><span class="k">-</span><span class="w"> </span>Get order status from order service
</span></code></pre></div>
<p><strong>Guidelines</strong>:</p>
<ol>
<li>Start natural, add explicitness only when needed</li>
<li>Use <code>$variables</code> when value is referenced multiple times</li>
<li>Use explicit calls for cross-agent or when parameters matter</li>
<li>Type annotations helpful for complex data: <code>$results:list</code>, <code>$config:dict</code></li>
</ol>
<hr />
<h2 id="multi-agent-programs">Multi-Agent Programs<a class="headerlink" href="#multi-agent-programs" title="Permanent link">&para;</a></h2>
<h3 id="when-to-use-multiple-agents">When to Use Multiple Agents<a class="headerlink" href="#when-to-use-multiple-agents" title="Permanent link">&para;</a></h3>
<p><strong>Use multiple agents when</strong>:</p>
<ul>
<li>✅ Different domains of expertise (TravelAdvisor, HotelAdvisor, FlightAdvisor)</li>
<li>✅ Different roles in process (Host, Player)</li>
<li>✅ Separation of concerns (Frontend, Backend, Database)</li>
<li>✅ Specialized models needed (FastAgent with GPT-4o-mini, ResearchAgent with Claude)</li>
<li>✅ Independent scaling or deployment</li>
<li>✅ Separation of LLM context and knowledge</li>
</ul>
<p><strong>Use single agent when</strong>:</p>
<ul>
<li>✅ Shared context and state</li>
<li>✅ Simple workflow</li>
<li>✅ Tight coupling between components</li>
</ul>
<h3 id="creating-multiple-agents">Creating Multiple Agents<a class="headerlink" href="#creating-multiple-agents" title="Permanent link">&para;</a></h3>
<p>Creating agents is easy in Playbooks. Simply add a new H1 tag and describe the agent.</p>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="gh"># PrimaryAgent</span>
</span><span id="__codeline__-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a>Description of primary agent
</span><span id="__codeline__-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a>
</span><span id="__codeline__-31-4"><a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a><span class="gu">## Main</span>
</span><span id="__codeline__-31-5"><a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a><span class="gu">### Triggers</span>
</span><span id="__codeline__-31-6"><a id="__codelineno-31-6" name="__codelineno-31-6" href="#__codelineno-31-6"></a><span class="k">-</span><span class="w"> </span>At the beginning
</span><span id="__codeline__-31-7"><a id="__codelineno-31-7" name="__codelineno-31-7" href="#__codelineno-31-7"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-31-8"><a id="__codelineno-31-8" name="__codelineno-31-8" href="#__codelineno-31-8"></a><span class="k">-</span><span class="w"> </span>Do primary work
</span><span id="__codeline__-31-9"><a id="__codelineno-31-9" name="__codelineno-31-9" href="#__codelineno-31-9"></a><span class="k">-</span><span class="w"> </span>Call SpecializedAgent when needed
</span><span id="__codeline__-31-10"><a id="__codelineno-31-10" name="__codelineno-31-10" href="#__codelineno-31-10"></a>
</span><span id="__codeline__-31-11"><a id="__codelineno-31-11" name="__codelineno-31-11" href="#__codelineno-31-11"></a><span class="gh"># SpecializedAgent  </span>
</span><span id="__codeline__-31-12"><a id="__codelineno-31-12" name="__codelineno-31-12" href="#__codelineno-31-12"></a>Description of specialized agent
</span><span id="__codeline__-31-13"><a id="__codelineno-31-13" name="__codelineno-31-13" href="#__codelineno-31-13"></a>
</span><span id="__codeline__-31-14"><a id="__codelineno-31-14" name="__codelineno-31-14" href="#__codelineno-31-14"></a><span class="gu">## ProcessTask($data)</span>
</span><span id="__codeline__-31-15"><a id="__codelineno-31-15" name="__codelineno-31-15" href="#__codelineno-31-15"></a>public: true
</span><span id="__codeline__-31-16"><a id="__codelineno-31-16" name="__codelineno-31-16" href="#__codelineno-31-16"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-31-17"><a id="__codelineno-31-17" name="__codelineno-31-17" href="#__codelineno-31-17"></a><span class="k">-</span><span class="w"> </span>Process $data with specialized logic
</span><span id="__codeline__-31-18"><a id="__codelineno-31-18" name="__codelineno-31-18" href="#__codelineno-31-18"></a><span class="k">-</span><span class="w"> </span>Return result
</span></code></pre></div>
<h3 id="agent-communication-methods">Agent Communication Methods<a class="headerlink" href="#agent-communication-methods" title="Permanent link">&para;</a></h3>
<h4 id="1-direct-public-playbook-calls">1. Direct Public Playbook Calls<a class="headerlink" href="#1-direct-public-playbook-calls" title="Permanent link">&para;</a></h4>
<p><strong>Most common</strong>: One agent directly calls another's public playbook</p>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="gh"># TaxAgent</span>
</span><span id="__codeline__-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a><span class="gu">## GetTaxRate($income)</span>
</span><span id="__codeline__-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a>public: true
</span><span id="__codeline__-32-4"><a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-32-5"><a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a><span class="k">-</span><span class="w"> </span>If $income &lt; 100000
</span><span id="__codeline__-32-6"><a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Return 15% tax rate
</span><span id="__codeline__-32-7"><a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a><span class="k">-</span><span class="w"> </span>Otherwise
</span><span id="__codeline__-32-8"><a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Return 25% tax rate
</span><span id="__codeline__-32-9"><a id="__codelineno-32-9" name="__codelineno-32-9" href="#__codelineno-32-9"></a>
</span><span id="__codeline__-32-10"><a id="__codelineno-32-10" name="__codelineno-32-10" href="#__codelineno-32-10"></a><span class="gh"># IncomeAgent</span>
</span><span id="__codeline__-32-11"><a id="__codelineno-32-11" name="__codelineno-32-11" href="#__codelineno-32-11"></a><span class="gu">## ProcessIncome</span>
</span><span id="__codeline__-32-12"><a id="__codelineno-32-12" name="__codelineno-32-12" href="#__codelineno-32-12"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-32-13"><a id="__codelineno-32-13" name="__codelineno-32-13" href="#__codelineno-32-13"></a><span class="k">-</span><span class="w"> </span>Ask user for $income
</span><span id="__codeline__-32-14"><a id="__codelineno-32-14" name="__codelineno-32-14" href="#__codelineno-32-14"></a><span class="k">-</span><span class="w"> </span>Ask Tax agent what the $tax_rate would be
</span><span id="__codeline__-32-15"><a id="__codelineno-32-15" name="__codelineno-32-15" href="#__codelineno-32-15"></a><span class="k">-</span><span class="w"> </span>Tell user their $tax_rate
</span></code></pre></div>
<p><strong>When to use</strong>:</p>
<ul>
<li>✅ Synchronous request-response</li>
<li>✅ Well-defined interface</li>
<li>✅ Return value needed immediately</li>
</ul>
<h4 id="2-natural-language-messaging">2. Natural Language Messaging<a class="headerlink" href="#2-natural-language-messaging" title="Permanent link">&para;</a></h4>
<p><strong>Send message to agent</strong>: For asynchronous communication</p>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="gh"># Manager</span>
</span><span id="__codeline__-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a><span class="gu">## AssignWork($task)</span>
</span><span id="__codeline__-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a><span class="k">-</span><span class="w"> </span>Decide which worker agent is best suited to handle $task
</span><span id="__codeline__-33-5"><a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a><span class="k">-</span><span class="w"> </span>Tell selected worker agent to work on $task
</span><span id="__codeline__-33-6"><a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a>
</span><span id="__codeline__-33-7"><a id="__codelineno-33-7" name="__codelineno-33-7" href="#__codelineno-33-7"></a><span class="gh"># WorkerAgent</span>
</span><span id="__codeline__-33-8"><a id="__codelineno-33-8" name="__codelineno-33-8" href="#__codelineno-33-8"></a><span class="gu">## PerformTask($task)</span>
</span><span id="__codeline__-33-9"><a id="__codelineno-33-9" name="__codelineno-33-9" href="#__codelineno-33-9"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-33-10"><a id="__codelineno-33-10" name="__codelineno-33-10" href="#__codelineno-33-10"></a><span class="k">-</span><span class="w"> </span>Perform the task
</span></code></pre></div>
<p><strong>When to use</strong>:</p>
<ul>
<li>✅ Fire-and-forget communication</li>
<li>✅ Event notifications</li>
<li>✅ Async workflows</li>
</ul>
<h4 id="3-meetings-multi-party-coordination">3. Meetings - Multi-Party Coordination<a class="headerlink" href="#3-meetings-multi-party-coordination" title="Permanent link">&para;</a></h4>
<p><strong>Host creates meeting</strong>: For multi-agent coordination</p>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="gh"># RestaurantConsultant</span>
</span><span id="__codeline__-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a><span class="gu">## MenuRedesignMeeting</span>
</span><span id="__codeline__-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a>meeting: true
</span><span id="__codeline__-34-4"><a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a>required_attendees: [HeadChef, MarketingSpecialist]
</span><span id="__codeline__-34-5"><a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a>
</span><span id="__codeline__-34-6"><a id="__codelineno-34-6" name="__codelineno-34-6" href="#__codelineno-34-6"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-34-7"><a id="__codelineno-34-7" name="__codelineno-34-7" href="#__codelineno-34-7"></a><span class="k">-</span><span class="w"> </span>Introduce myself and explain meeting purpose
</span><span id="__codeline__-34-8"><a id="__codelineno-34-8" name="__codelineno-34-8" href="#__codelineno-34-8"></a><span class="k">-</span><span class="w"> </span>Explain the process we&#39;ll follow
</span><span id="__codeline__-34-9"><a id="__codelineno-34-9" name="__codelineno-34-9" href="#__codelineno-34-9"></a><span class="k">-</span><span class="w"> </span>While meeting is active
</span><span id="__codeline__-34-10"><a id="__codelineno-34-10" name="__codelineno-34-10" href="#__codelineno-34-10"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Facilitate discussion
</span><span id="__codeline__-34-11"><a id="__codelineno-34-11" name="__codelineno-34-11" href="#__codelineno-34-11"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Keep discussion on track
</span><span id="__codeline__-34-12"><a id="__codelineno-34-12" name="__codelineno-34-12" href="#__codelineno-34-12"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Enforce max 30 turns
</span><span id="__codeline__-34-13"><a id="__codelineno-34-13" name="__codelineno-34-13" href="#__codelineno-34-13"></a><span class="k">-</span><span class="w"> </span>If consensus reached
</span><span id="__codeline__-34-14"><a id="__codelineno-34-14" name="__codelineno-34-14" href="#__codelineno-34-14"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Summarize decisions
</span><span id="__codeline__-34-15"><a id="__codelineno-34-15" name="__codelineno-34-15" href="#__codelineno-34-15"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>End meeting
</span><span id="__codeline__-34-16"><a id="__codelineno-34-16" name="__codelineno-34-16" href="#__codelineno-34-16"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Return menu proposal
</span><span id="__codeline__-34-17"><a id="__codelineno-34-17" name="__codelineno-34-17" href="#__codelineno-34-17"></a><span class="k">-</span><span class="w"> </span>Otherwise
</span><span id="__codeline__-34-18"><a id="__codelineno-34-18" name="__codelineno-34-18" href="#__codelineno-34-18"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Return failure reason
</span><span id="__codeline__-34-19"><a id="__codelineno-34-19" name="__codelineno-34-19" href="#__codelineno-34-19"></a>
</span><span id="__codeline__-34-20"><a id="__codelineno-34-20" name="__codelineno-34-20" href="#__codelineno-34-20"></a><span class="gh"># HeadChef</span>
</span><span id="__codeline__-34-21"><a id="__codelineno-34-21" name="__codelineno-34-21" href="#__codelineno-34-21"></a><span class="gu">## MenuRedesignMeeting</span>
</span><span id="__codeline__-34-22"><a id="__codelineno-34-22" name="__codelineno-34-22" href="#__codelineno-34-22"></a>meeting: true
</span><span id="__codeline__-34-23"><a id="__codelineno-34-23" name="__codelineno-34-23" href="#__codelineno-34-23"></a>
</span><span id="__codeline__-34-24"><a id="__codelineno-34-24" name="__codelineno-34-24" href="#__codelineno-34-24"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-34-25"><a id="__codelineno-34-25" name="__codelineno-34-25" href="#__codelineno-34-25"></a><span class="k">-</span><span class="w"> </span>Introduce myself
</span><span id="__codeline__-34-26"><a id="__codelineno-34-26" name="__codelineno-34-26" href="#__codelineno-34-26"></a><span class="k">-</span><span class="w"> </span>While meeting is active
</span><span id="__codeline__-34-27"><a id="__codelineno-34-27" name="__codelineno-34-27" href="#__codelineno-34-27"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>When asked about dish proposals
</span><span id="__codeline__-34-28"><a id="__codelineno-34-28" name="__codelineno-34-28" href="#__codelineno-34-28"></a><span class="w">    </span><span class="k">-</span><span class="w"> </span>Propose 3-5 signature dishes with costs
</span><span id="__codeline__-34-29"><a id="__codelineno-34-29" name="__codelineno-34-29" href="#__codelineno-34-29"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>When MarketingSpecialist suggests trends
</span><span id="__codeline__-34-30"><a id="__codelineno-34-30" name="__codelineno-34-30" href="#__codelineno-34-30"></a><span class="w">    </span><span class="k">-</span><span class="w"> </span>Evaluate feasibility
</span><span id="__codeline__-34-31"><a id="__codelineno-34-31" name="__codelineno-34-31" href="#__codelineno-34-31"></a><span class="w">    </span><span class="k">-</span><span class="w"> </span>Suggest alternatives if needed
</span><span id="__codeline__-34-32"><a id="__codelineno-34-32" name="__codelineno-34-32" href="#__codelineno-34-32"></a>
</span><span id="__codeline__-34-33"><a id="__codelineno-34-33" name="__codelineno-34-33" href="#__codelineno-34-33"></a><span class="gh"># MarketingSpecialist</span>
</span><span id="__codeline__-34-34"><a id="__codelineno-34-34" name="__codelineno-34-34" href="#__codelineno-34-34"></a><span class="gu">## MenuRedesignMeeting</span>
</span><span id="__codeline__-34-35"><a id="__codelineno-34-35" name="__codelineno-34-35" href="#__codelineno-34-35"></a>meeting: true
</span><span id="__codeline__-34-36"><a id="__codelineno-34-36" name="__codelineno-34-36" href="#__codelineno-34-36"></a>
</span><span id="__codeline__-34-37"><a id="__codelineno-34-37" name="__codelineno-34-37" href="#__codelineno-34-37"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-34-38"><a id="__codelineno-34-38" name="__codelineno-34-38" href="#__codelineno-34-38"></a><span class="k">-</span><span class="w"> </span>Introduce myself
</span><span id="__codeline__-34-39"><a id="__codelineno-34-39" name="__codelineno-34-39" href="#__codelineno-34-39"></a><span class="k">-</span><span class="w"> </span>Present market analysis
</span><span id="__codeline__-34-40"><a id="__codelineno-34-40" name="__codelineno-34-40" href="#__codelineno-34-40"></a><span class="k">-</span><span class="w"> </span>While meeting is active
</span><span id="__codeline__-34-41"><a id="__codelineno-34-41" name="__codelineno-34-41" href="#__codelineno-34-41"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>When HeadChef proposes dishes
</span><span id="__codeline__-34-42"><a id="__codelineno-34-42" name="__codelineno-34-42" href="#__codelineno-34-42"></a><span class="w">    </span><span class="k">-</span><span class="w"> </span>Evaluate market appeal
</span><span id="__codeline__-34-43"><a id="__codelineno-34-43" name="__codelineno-34-43" href="#__codelineno-34-43"></a><span class="w">    </span><span class="k">-</span><span class="w"> </span>Suggest pricing
</span><span id="__codeline__-34-44"><a id="__codelineno-34-44" name="__codelineno-34-44" href="#__codelineno-34-44"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>When consensus difficult
</span><span id="__codeline__-34-45"><a id="__codelineno-34-45" name="__codelineno-34-45" href="#__codelineno-34-45"></a><span class="w">    </span><span class="k">-</span><span class="w"> </span>Share customer feedback
</span></code></pre></div>
<p><strong>To create meeting</strong>:</p>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="k">-</span><span class="w"> </span>Start a menu redesign meeting with HeadChef and MarketingSpecialist
</span></code></pre></div>
<p><strong>Meeting mechanics</strong>:</p>
<ul>
<li>Each agent needs a playbook with <code>meeting: true</code></li>
<li>Same playbook name across all participating agents</li>
<li>Host agent creates meeting, invites attendees</li>
<li>Meeting provides shared communication channel</li>
<li>Messages visible to all participants</li>
<li>Meeting ends when host returns from meeting playbook</li>
</ul>
<p><strong>When to use meetings</strong>:</p>
<ul>
<li>✅ Multiple agents need to coordinate</li>
<li>✅ Shared context across participants</li>
<li>✅ Back-and-forth discussion needed</li>
<li>✅ Consensus building</li>
</ul>
<h3 id="multi-agent-best-practices">Multi-Agent Best Practices<a class="headerlink" href="#multi-agent-best-practices" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Clear interfaces</strong>: Mark playbooks <code>public: true</code> when designed for cross-agent calls</li>
<li><strong>Meaningful agent names</strong>: <code>TaxAccountant</code> not <code>Agent2</code></li>
<li><strong>Document cross-agent contracts</strong>: What parameters, what returns</li>
<li><strong>Handle failures</strong>: What if agent doesn't respond?</li>
<li><strong>Avoid circular dependencies</strong>: Agent A → Agent B → Agent A can deadlock</li>
</ol>
<hr />
<h2 id="triggers-event-driven-programming">Triggers: Event-Driven Programming<a class="headerlink" href="#triggers-event-driven-programming" title="Permanent link">&para;</a></h2>
<p>Triggers are natural language conditions that cause playbooks to execute automatically - like CPU interrupts. They enable declarative, reactive behavior in your agents.</p>
<p>⚠️ <strong>Use Sparingly</strong>: Triggers add "magic" behavior that can make programs harder to understand. Only use them when they significantly simplify your code.</p>
<h3 id="why-use-triggers">Why Use Triggers?<a class="headerlink" href="#why-use-triggers" title="Permanent link">&para;</a></h3>
<p>Triggers eliminate repetitive coordination code by automatically invoking playbooks when conditions are met. The primary use case is <strong>input validation</strong> - you can validate user input automatically without cluttering your main flow with validation logic.</p>
<h3 id="when-to-use-triggers">When to Use Triggers<a class="headerlink" href="#when-to-use-triggers" title="Permanent link">&para;</a></h3>
<p>✅ <strong>DO use triggers for</strong>:</p>
<ul>
<li><strong>Input validation</strong> - Automatically validate when user provides data</li>
<li><strong>State monitoring</strong> - React to threshold violations or state changes</li>
<li><strong>Cross-cutting concerns</strong> - Behavior that applies throughout execution</li>
<li><strong>Entry points</strong> - "At the beginning" to start your program</li>
</ul>
<p>❌ <strong>DON'T use triggers for</strong>:</p>
<ul>
<li>Normal sequential logic (just use steps)</li>
<li>One-time checks (inline them instead)</li>
<li>Complex workflows (be explicit with function calls)</li>
<li>When the trigger condition is unclear</li>
</ul>
<h3 id="the-validation-pattern-before-after">The Validation Pattern: Before &amp; After<a class="headerlink" href="#the-validation-pattern-before-after" title="Permanent link">&para;</a></h3>
<p><strong>WITHOUT Triggers</strong> (explicit validation):</p>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="gu">## Main</span>
</span><span id="__codeline__-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-36-3"><a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a><span class="k">-</span><span class="w"> </span>Ask user for their $email
</span><span id="__codeline__-36-4"><a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a><span class="k">-</span><span class="w"> </span>Validate $email and keep asking until valid
</span><span id="__codeline__-36-5"><a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a><span class="k">-</span><span class="w"> </span>Ask user for their $pin
</span><span id="__codeline__-36-6"><a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a><span class="k">-</span><span class="w"> </span>Validate $pin and keep asking until valid
</span><span id="__codeline__-36-7"><a id="__codelineno-36-7" name="__codelineno-36-7" href="#__codelineno-36-7"></a><span class="k">-</span><span class="w"> </span>Process login with $email and $pin
</span><span id="__codeline__-36-8"><a id="__codelineno-36-8" name="__codelineno-36-8" href="#__codelineno-36-8"></a>
</span><span id="__codeline__-36-9"><a id="__codelineno-36-9" name="__codelineno-36-9" href="#__codelineno-36-9"></a><span class="gu">## ValidateEmail($email)</span>
</span><span id="__codeline__-36-10"><a id="__codelineno-36-10" name="__codelineno-36-10" href="#__codelineno-36-10"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-36-11"><a id="__codelineno-36-11" name="__codelineno-36-11" href="#__codelineno-36-11"></a><span class="k">-</span><span class="w"> </span>While $email format is invalid
</span><span id="__codeline__-36-12"><a id="__codelineno-36-12" name="__codelineno-36-12" href="#__codelineno-36-12"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Tell user email is invalid
</span><span id="__codeline__-36-13"><a id="__codelineno-36-13" name="__codelineno-36-13" href="#__codelineno-36-13"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Ask for email again
</span><span id="__codeline__-36-14"><a id="__codelineno-36-14" name="__codelineno-36-14" href="#__codelineno-36-14"></a><span class="k">-</span><span class="w"> </span>Return valid email
</span><span id="__codeline__-36-15"><a id="__codelineno-36-15" name="__codelineno-36-15" href="#__codelineno-36-15"></a>
</span><span id="__codeline__-36-16"><a id="__codelineno-36-16" name="__codelineno-36-16" href="#__codelineno-36-16"></a><span class="gu">## ValidatePIN($pin)</span>
</span><span id="__codeline__-36-17"><a id="__codelineno-36-17" name="__codelineno-36-17" href="#__codelineno-36-17"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-36-18"><a id="__codelineno-36-18" name="__codelineno-36-18" href="#__codelineno-36-18"></a><span class="k">-</span><span class="w"> </span>While $pin is not 4 digits
</span><span id="__codeline__-36-19"><a id="__codelineno-36-19" name="__codelineno-36-19" href="#__codelineno-36-19"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Tell user PIN must be 4 digits
</span><span id="__codeline__-36-20"><a id="__codelineno-36-20" name="__codelineno-36-20" href="#__codelineno-36-20"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Ask for PIN again
</span><span id="__codeline__-36-21"><a id="__codelineno-36-21" name="__codelineno-36-21" href="#__codelineno-36-21"></a><span class="k">-</span><span class="w"> </span>Return valid PIN
</span></code></pre></div>
<p><strong>WITH Triggers</strong> (automatic validation):</p>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="gu">## Main</span>
</span><span id="__codeline__-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-37-3"><a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a><span class="k">-</span><span class="w"> </span>Ask user for their $email
</span><span id="__codeline__-37-4"><a id="__codelineno-37-4" name="__codelineno-37-4" href="#__codelineno-37-4"></a><span class="k">-</span><span class="w"> </span>Ask user for their $pin
</span><span id="__codeline__-37-5"><a id="__codelineno-37-5" name="__codelineno-37-5" href="#__codelineno-37-5"></a><span class="k">-</span><span class="w"> </span>Process login with $email and $pin
</span><span id="__codeline__-37-6"><a id="__codelineno-37-6" name="__codelineno-37-6" href="#__codelineno-37-6"></a>
</span><span id="__codeline__-37-7"><a id="__codelineno-37-7" name="__codelineno-37-7" href="#__codelineno-37-7"></a><span class="gu">## ValidateEmail</span>
</span><span id="__codeline__-37-8"><a id="__codelineno-37-8" name="__codelineno-37-8" href="#__codelineno-37-8"></a><span class="gu">### Triggers</span>
</span><span id="__codeline__-37-9"><a id="__codelineno-37-9" name="__codelineno-37-9" href="#__codelineno-37-9"></a><span class="k">-</span><span class="w"> </span>When user provides email
</span><span id="__codeline__-37-10"><a id="__codelineno-37-10" name="__codelineno-37-10" href="#__codelineno-37-10"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-37-11"><a id="__codelineno-37-11" name="__codelineno-37-11" href="#__codelineno-37-11"></a><span class="k">-</span><span class="w"> </span>If $email format is invalid
</span><span id="__codeline__-37-12"><a id="__codelineno-37-12" name="__codelineno-37-12" href="#__codelineno-37-12"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Tell user email is invalid
</span><span id="__codeline__-37-13"><a id="__codelineno-37-13" name="__codelineno-37-13" href="#__codelineno-37-13"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Ask for email again
</span><span id="__codeline__-37-14"><a id="__codelineno-37-14" name="__codelineno-37-14" href="#__codelineno-37-14"></a>
</span><span id="__codeline__-37-15"><a id="__codelineno-37-15" name="__codelineno-37-15" href="#__codelineno-37-15"></a><span class="gu">## ValidatePIN</span>
</span><span id="__codeline__-37-16"><a id="__codelineno-37-16" name="__codelineno-37-16" href="#__codelineno-37-16"></a><span class="gu">### Triggers</span>
</span><span id="__codeline__-37-17"><a id="__codelineno-37-17" name="__codelineno-37-17" href="#__codelineno-37-17"></a><span class="k">-</span><span class="w"> </span>When user provides PIN
</span><span id="__codeline__-37-18"><a id="__codelineno-37-18" name="__codelineno-37-18" href="#__codelineno-37-18"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-37-19"><a id="__codelineno-37-19" name="__codelineno-37-19" href="#__codelineno-37-19"></a><span class="k">-</span><span class="w"> </span>If $pin is not 4 digits
</span><span id="__codeline__-37-20"><a id="__codelineno-37-20" name="__codelineno-37-20" href="#__codelineno-37-20"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Tell user PIN must be 4 digits
</span><span id="__codeline__-37-21"><a id="__codelineno-37-21" name="__codelineno-37-21" href="#__codelineno-37-21"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Ask for PIN again
</span></code></pre></div>
<p><strong>Key Benefit</strong>: Main flow stays clean. Validation happens automatically whenever user provides input. No need to explicitly call validation at each input point.</p>
<h3 id="trigger-types">Trigger Types<a class="headerlink" href="#trigger-types" title="Permanent link">&para;</a></h3>
<p><strong>Temporal</strong>:</p>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="gu">### Triggers</span>
</span><span id="__codeline__-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a><span class="k">-</span><span class="w"> </span>At the beginning
</span><span id="__codeline__-38-3"><a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a><span class="k">-</span><span class="w"> </span>After 5 minutes
</span><span id="__codeline__-38-4"><a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a><span class="k">-</span><span class="w"> </span>At the end
</span></code></pre></div>
<p><strong>State-Based</strong>:</p>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a><span class="gu">### Triggers</span>
</span><span id="__codeline__-39-2"><a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a><span class="k">-</span><span class="w"> </span>When $attempts &gt; 3
</span><span id="__codeline__-39-3"><a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a><span class="k">-</span><span class="w"> </span>When $balance becomes negative
</span><span id="__codeline__-39-4"><a id="__codelineno-39-4" name="__codelineno-39-4" href="#__codelineno-39-4"></a><span class="k">-</span><span class="w"> </span>When $order_status is &quot;shipped&quot;
</span></code></pre></div>
<p><strong>User Interaction</strong>:</p>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a><span class="gu">### Triggers</span>
</span><span id="__codeline__-40-2"><a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a><span class="k">-</span><span class="w"> </span>When user provides email
</span><span id="__codeline__-40-3"><a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a><span class="k">-</span><span class="w"> </span>When user asks about refund
</span><span id="__codeline__-40-4"><a id="__codelineno-40-4" name="__codelineno-40-4" href="#__codelineno-40-4"></a><span class="k">-</span><span class="w"> </span>When user seems frustrated
</span></code></pre></div>
<p><strong>Execution Flow</strong>:</p>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a><span class="gu">### Triggers</span>
</span><span id="__codeline__-41-2"><a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a><span class="k">-</span><span class="w"> </span>After calling ProcessPayment
</span><span id="__codeline__-41-3"><a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a><span class="k">-</span><span class="w"> </span>Before ending program
</span></code></pre></div>
<p><strong>External Events</strong>:</p>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a><span class="gu">### Triggers</span>
</span><span id="__codeline__-42-2"><a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a><span class="k">-</span><span class="w"> </span>When payment webhook is received
</span><span id="__codeline__-42-3"><a id="__codelineno-42-3" name="__codelineno-42-3" href="#__codelineno-42-3"></a><span class="k">-</span><span class="w"> </span>When inventory drops below threshold
</span></code></pre></div>
<p><strong>Agent Communication</strong>:</p>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a><span class="gu">### Triggers</span>
</span><span id="__codeline__-43-2"><a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a><span class="k">-</span><span class="w"> </span>When another agent asks about availability
</span><span id="__codeline__-43-3"><a id="__codelineno-43-3" name="__codelineno-43-3" href="#__codelineno-43-3"></a><span class="k">-</span><span class="w"> </span>When Manager assigns new task
</span></code></pre></div>
<h3 id="common-trigger-patterns">Common Trigger Patterns<a class="headerlink" href="#common-trigger-patterns" title="Permanent link">&para;</a></h3>
<p><strong>Pattern 1: Input Validation</strong></p>
<p>The most common use case - validate input automatically:</p>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a><span class="gu">## Main</span>
</span><span id="__codeline__-44-2"><a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-44-3"><a id="__codelineno-44-3" name="__codelineno-44-3" href="#__codelineno-44-3"></a><span class="k">-</span><span class="w"> </span>Ask user for their $order_id till user provides a valid order id
</span><span id="__codeline__-44-4"><a id="__codelineno-44-4" name="__codelineno-44-4" href="#__codelineno-44-4"></a><span class="k">-</span><span class="w"> </span>Process the order
</span><span id="__codeline__-44-5"><a id="__codelineno-44-5" name="__codelineno-44-5" href="#__codelineno-44-5"></a>
</span><span id="__codeline__-44-6"><a id="__codelineno-44-6" name="__codelineno-44-6" href="#__codelineno-44-6"></a><span class="gu">## ValidateOrderId</span>
</span><span id="__codeline__-44-7"><a id="__codelineno-44-7" name="__codelineno-44-7" href="#__codelineno-44-7"></a><span class="gu">### Triggers</span>
</span><span id="__codeline__-44-8"><a id="__codelineno-44-8" name="__codelineno-44-8" href="#__codelineno-44-8"></a><span class="k">-</span><span class="w"> </span>When user provides order id
</span><span id="__codeline__-44-9"><a id="__codelineno-44-9" name="__codelineno-44-9" href="#__codelineno-44-9"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-44-10"><a id="__codelineno-44-10" name="__codelineno-44-10" href="#__codelineno-44-10"></a><span class="k">-</span><span class="w"> </span>If $order_id is not 8 digits
</span><span id="__codeline__-44-11"><a id="__codelineno-44-11" name="__codelineno-44-11" href="#__codelineno-44-11"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Tell user order ID must be exactly 8 digits
</span><span id="__codeline__-44-12"><a id="__codelineno-44-12" name="__codelineno-44-12" href="#__codelineno-44-12"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Ask for order ID again
</span></code></pre></div>
<p><strong>Pattern 2: State Guard</strong></p>
<p>Monitor state and react to violations:</p>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a><span class="gu">## Main</span>
</span><span id="__codeline__-45-2"><a id="__codelineno-45-2" name="__codelineno-45-2" href="#__codelineno-45-2"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-45-3"><a id="__codelineno-45-3" name="__codelineno-45-3" href="#__codelineno-45-3"></a><span class="k">-</span><span class="w"> </span>Set $attempts to 0
</span><span id="__codeline__-45-4"><a id="__codelineno-45-4" name="__codelineno-45-4" href="#__codelineno-45-4"></a><span class="k">-</span><span class="w"> </span>While not authenticated
</span><span id="__codeline__-45-5"><a id="__codelineno-45-5" name="__codelineno-45-5" href="#__codelineno-45-5"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Ask user for credentials
</span><span id="__codeline__-45-6"><a id="__codelineno-45-6" name="__codelineno-45-6" href="#__codelineno-45-6"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Increment $attempts
</span><span id="__codeline__-45-7"><a id="__codelineno-45-7" name="__codelineno-45-7" href="#__codelineno-45-7"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Attempt authentication
</span><span id="__codeline__-45-8"><a id="__codelineno-45-8" name="__codelineno-45-8" href="#__codelineno-45-8"></a>
</span><span id="__codeline__-45-9"><a id="__codelineno-45-9" name="__codelineno-45-9" href="#__codelineno-45-9"></a><span class="gu">## CheckAttemptLimit</span>
</span><span id="__codeline__-45-10"><a id="__codelineno-45-10" name="__codelineno-45-10" href="#__codelineno-45-10"></a><span class="gu">### Triggers</span>
</span><span id="__codeline__-45-11"><a id="__codelineno-45-11" name="__codelineno-45-11" href="#__codelineno-45-11"></a><span class="k">-</span><span class="w"> </span>When $attempts &gt; 5
</span><span id="__codeline__-45-12"><a id="__codelineno-45-12" name="__codelineno-45-12" href="#__codelineno-45-12"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-45-13"><a id="__codelineno-45-13" name="__codelineno-45-13" href="#__codelineno-45-13"></a><span class="k">-</span><span class="w"> </span>Tell user they&#39;ve exceeded maximum attempts
</span><span id="__codeline__-45-14"><a id="__codelineno-45-14" name="__codelineno-45-14" href="#__codelineno-45-14"></a><span class="k">-</span><span class="w"> </span>End program
</span></code></pre></div>
<p><strong>Pattern 3: Intent Detection</strong></p>
<p>Respond to user intent automatically:</p>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-46-1"><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a><span class="gu">## Main</span>
</span><span id="__codeline__-46-2"><a id="__codelineno-46-2" name="__codelineno-46-2" href="#__codelineno-46-2"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-46-3"><a id="__codelineno-46-3" name="__codelineno-46-3" href="#__codelineno-46-3"></a><span class="k">-</span><span class="w"> </span>Welcome user
</span><span id="__codeline__-46-4"><a id="__codelineno-46-4" name="__codelineno-46-4" href="#__codelineno-46-4"></a><span class="k">-</span><span class="w"> </span>Have conversation about their issue
</span><span id="__codeline__-46-5"><a id="__codelineno-46-5" name="__codelineno-46-5" href="#__codelineno-46-5"></a><span class="k">-</span><span class="w"> </span>Resolve the issue
</span><span id="__codeline__-46-6"><a id="__codelineno-46-6" name="__codelineno-46-6" href="#__codelineno-46-6"></a>
</span><span id="__codeline__-46-7"><a id="__codelineno-46-7" name="__codelineno-46-7" href="#__codelineno-46-7"></a><span class="gu">## ProvideHelp</span>
</span><span id="__codeline__-46-8"><a id="__codelineno-46-8" name="__codelineno-46-8" href="#__codelineno-46-8"></a><span class="gu">### Triggers  </span>
</span><span id="__codeline__-46-9"><a id="__codelineno-46-9" name="__codelineno-46-9" href="#__codelineno-46-9"></a><span class="k">-</span><span class="w"> </span>When user asks for help
</span><span id="__codeline__-46-10"><a id="__codelineno-46-10" name="__codelineno-46-10" href="#__codelineno-46-10"></a><span class="k">-</span><span class="w"> </span>When user seems confused
</span><span id="__codeline__-46-11"><a id="__codelineno-46-11" name="__codelineno-46-11" href="#__codelineno-46-11"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-46-12"><a id="__codelineno-46-12" name="__codelineno-46-12" href="#__codelineno-46-12"></a><span class="k">-</span><span class="w"> </span>Explain available options and how to use them
</span><span id="__codeline__-46-13"><a id="__codelineno-46-13" name="__codelineno-46-13" href="#__codelineno-46-13"></a><span class="k">-</span><span class="w"> </span>Ask what specific help they need
</span></code></pre></div>
<p><strong>Pattern 4: RFC-Compliant Validation</strong></p>
<p>Use triggers with detailed validation requirements:</p>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-47-1"><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a><span class="gu">## ValidateEmail</span>
</span><span id="__codeline__-47-2"><a id="__codelineno-47-2" name="__codelineno-47-2" href="#__codelineno-47-2"></a>Validates provided email. Email address must conform to addr-spec in Section 3.4 of RFC 5322:
</span><span id="__codeline__-47-3"><a id="__codelineno-47-3" name="__codelineno-47-3" href="#__codelineno-47-3"></a>  addr-spec = local-part &quot;@&quot; domain
</span><span id="__codeline__-47-4"><a id="__codelineno-47-4" name="__codelineno-47-4" href="#__codelineno-47-4"></a>
</span><span id="__codeline__-47-5"><a id="__codelineno-47-5" name="__codelineno-47-5" href="#__codelineno-47-5"></a><span class="gu">### Triggers</span>
</span><span id="__codeline__-47-6"><a id="__codelineno-47-6" name="__codelineno-47-6" href="#__codelineno-47-6"></a><span class="k">-</span><span class="w"> </span>When user provides an email
</span><span id="__codeline__-47-7"><a id="__codelineno-47-7" name="__codelineno-47-7" href="#__codelineno-47-7"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-47-8"><a id="__codelineno-47-8" name="__codelineno-47-8" href="#__codelineno-47-8"></a><span class="k">-</span><span class="w"> </span>While $email is not valid according to RFC 5322
</span><span id="__codeline__-47-9"><a id="__codelineno-47-9" name="__codelineno-47-9" href="#__codelineno-47-9"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Tell user email format is invalid
</span><span id="__codeline__-47-10"><a id="__codelineno-47-10" name="__codelineno-47-10" href="#__codelineno-47-10"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Ask for email again
</span><span id="__codeline__-47-11"><a id="__codelineno-47-11" name="__codelineno-47-11" href="#__codelineno-47-11"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>If user gives up
</span><span id="__codeline__-47-12"><a id="__codelineno-47-12" name="__codelineno-47-12" href="#__codelineno-47-12"></a><span class="w">    </span><span class="k">-</span><span class="w"> </span>Apologize and end the conversation
</span></code></pre></div>
<h3 id="how-triggers-simplify-programs">How Triggers Simplify Programs<a class="headerlink" href="#how-triggers-simplify-programs" title="Permanent link">&para;</a></h3>
<p><strong>Example: Order Processing with Multiple Validations</strong></p>
<p><strong>WITHOUT Triggers</strong> - Repetitive validation calls:</p>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-48-1"><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a><span class="gu">## Main</span>
</span><span id="__codeline__-48-2"><a id="__codelineno-48-2" name="__codelineno-48-2" href="#__codelineno-48-2"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-48-3"><a id="__codelineno-48-3" name="__codelineno-48-3" href="#__codelineno-48-3"></a><span class="k">-</span><span class="w"> </span>Ask user for $order_id
</span><span id="__codeline__-48-4"><a id="__codelineno-48-4" name="__codelineno-48-4" href="#__codelineno-48-4"></a><span class="k">-</span><span class="w"> </span>ValidateOrderId($order_id) and keep asking till valid
</span><span id="__codeline__-48-5"><a id="__codelineno-48-5" name="__codelineno-48-5" href="#__codelineno-48-5"></a><span class="k">-</span><span class="w"> </span>Ask user for $email
</span><span id="__codeline__-48-6"><a id="__codelineno-48-6" name="__codelineno-48-6" href="#__codelineno-48-6"></a><span class="k">-</span><span class="w"> </span>ValidateEmail($email) and keep asking till valid
</span><span id="__codeline__-48-7"><a id="__codelineno-48-7" name="__codelineno-48-7" href="#__codelineno-48-7"></a><span class="k">-</span><span class="w"> </span>Ask user for $shipping_address
</span><span id="__codeline__-48-8"><a id="__codelineno-48-8" name="__codelineno-48-8" href="#__codelineno-48-8"></a><span class="k">-</span><span class="w"> </span>ValidateShippingAddress($shipping_address) and keep asking till valid
</span><span id="__codeline__-48-9"><a id="__codelineno-48-9" name="__codelineno-48-9" href="#__codelineno-48-9"></a><span class="k">-</span><span class="w"> </span>Process order
</span></code></pre></div>
<p><strong>WITH Triggers</strong> - Clean main flow:</p>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-49-1"><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a><span class="gu">## Main</span>
</span><span id="__codeline__-49-2"><a id="__codelineno-49-2" name="__codelineno-49-2" href="#__codelineno-49-2"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-49-3"><a id="__codelineno-49-3" name="__codelineno-49-3" href="#__codelineno-49-3"></a><span class="k">-</span><span class="w"> </span>Ask user for $order_id
</span><span id="__codeline__-49-4"><a id="__codelineno-49-4" name="__codelineno-49-4" href="#__codelineno-49-4"></a><span class="k">-</span><span class="w"> </span>Ask user for $email
</span><span id="__codeline__-49-5"><a id="__codelineno-49-5" name="__codelineno-49-5" href="#__codelineno-49-5"></a><span class="k">-</span><span class="w"> </span>Ask user for $shipping_address
</span><span id="__codeline__-49-6"><a id="__codelineno-49-6" name="__codelineno-49-6" href="#__codelineno-49-6"></a><span class="k">-</span><span class="w"> </span>Process order
</span><span id="__codeline__-49-7"><a id="__codelineno-49-7" name="__codelineno-49-7" href="#__codelineno-49-7"></a>
</span><span id="__codeline__-49-8"><a id="__codelineno-49-8" name="__codelineno-49-8" href="#__codelineno-49-8"></a><span class="gu">## ValidateOrderId</span>
</span><span id="__codeline__-49-9"><a id="__codelineno-49-9" name="__codelineno-49-9" href="#__codelineno-49-9"></a><span class="gu">### Triggers</span>
</span><span id="__codeline__-49-10"><a id="__codelineno-49-10" name="__codelineno-49-10" href="#__codelineno-49-10"></a><span class="k">-</span><span class="w"> </span>When user provides order id
</span><span id="__codeline__-49-11"><a id="__codelineno-49-11" name="__codelineno-49-11" href="#__codelineno-49-11"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-49-12"><a id="__codelineno-49-12" name="__codelineno-49-12" href="#__codelineno-49-12"></a><span class="k">-</span><span class="w"> </span>If $order_id is not 8 digits
</span><span id="__codeline__-49-13"><a id="__codelineno-49-13" name="__codelineno-49-13" href="#__codelineno-49-13"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Tell user order ID must be 8 digits
</span><span id="__codeline__-49-14"><a id="__codelineno-49-14" name="__codelineno-49-14" href="#__codelineno-49-14"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Ask again
</span><span id="__codeline__-49-15"><a id="__codelineno-49-15" name="__codelineno-49-15" href="#__codelineno-49-15"></a>
</span><span id="__codeline__-49-16"><a id="__codelineno-49-16" name="__codelineno-49-16" href="#__codelineno-49-16"></a><span class="gu">## ValidateEmail</span>
</span><span id="__codeline__-49-17"><a id="__codelineno-49-17" name="__codelineno-49-17" href="#__codelineno-49-17"></a><span class="gu">### Triggers</span>
</span><span id="__codeline__-49-18"><a id="__codelineno-49-18" name="__codelineno-49-18" href="#__codelineno-49-18"></a><span class="k">-</span><span class="w"> </span>When user provides email
</span><span id="__codeline__-49-19"><a id="__codelineno-49-19" name="__codelineno-49-19" href="#__codelineno-49-19"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-49-20"><a id="__codelineno-49-20" name="__codelineno-49-20" href="#__codelineno-49-20"></a><span class="k">-</span><span class="w"> </span>If $email format is invalid
</span><span id="__codeline__-49-21"><a id="__codelineno-49-21" name="__codelineno-49-21" href="#__codelineno-49-21"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Tell user email is invalid
</span><span id="__codeline__-49-22"><a id="__codelineno-49-22" name="__codelineno-49-22" href="#__codelineno-49-22"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Ask again
</span><span id="__codeline__-49-23"><a id="__codelineno-49-23" name="__codelineno-49-23" href="#__codelineno-49-23"></a>
</span><span id="__codeline__-49-24"><a id="__codelineno-49-24" name="__codelineno-49-24" href="#__codelineno-49-24"></a><span class="gu">## ValidateShippingAddress</span>
</span><span id="__codeline__-49-25"><a id="__codelineno-49-25" name="__codelineno-49-25" href="#__codelineno-49-25"></a><span class="gu">### Triggers</span>
</span><span id="__codeline__-49-26"><a id="__codelineno-49-26" name="__codelineno-49-26" href="#__codelineno-49-26"></a><span class="k">-</span><span class="w"> </span>When user provides shipping address
</span><span id="__codeline__-49-27"><a id="__codelineno-49-27" name="__codelineno-49-27" href="#__codelineno-49-27"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-49-28"><a id="__codelineno-49-28" name="__codelineno-49-28" href="#__codelineno-49-28"></a><span class="k">-</span><span class="w"> </span>If $shipping_address is incomplete
</span><span id="__codeline__-49-29"><a id="__codelineno-49-29" name="__codelineno-49-29" href="#__codelineno-49-29"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Tell user what&#39;s missing
</span><span id="__codeline__-49-30"><a id="__codelineno-49-30" name="__codelineno-49-30" href="#__codelineno-49-30"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Ask for complete address
</span></code></pre></div>
<h3 id="trigger-execution-model">Trigger Execution Model<a class="headerlink" href="#trigger-execution-model" title="Permanent link">&para;</a></h3>
<p><strong>How triggers work</strong>:</p>
<ol>
<li>Main playbook asks for input: "Ask user for their $email"</li>
<li>User provides input</li>
<li>Runtime checks all triggers for matching conditions</li>
<li>First matching trigger fires: "When user provides email"</li>
<li>Validation playbook executes</li>
<li>If validation fails, it asks again (loop)</li>
<li>Control returns to main playbook when input is valid</li>
</ol>
<p><strong>Important</strong>: Triggers are evaluated after each step. The LLM determines when a trigger condition is met based on semantic understanding.</p>
<h3 id="when-not-to-use-triggers">When NOT to Use Triggers<a class="headerlink" href="#when-not-to-use-triggers" title="Permanent link">&para;</a></h3>
<p><strong>Don't use triggers when explicit flow is clearer</strong>:</p>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-50-1"><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a>&lt;!-- BAD: Trigger makes flow unclear --&gt;
</span><span id="__codeline__-50-2"><a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a><span class="gu">## Main</span>
</span><span id="__codeline__-50-3"><a id="__codelineno-50-3" name="__codelineno-50-3" href="#__codelineno-50-3"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-50-4"><a id="__codelineno-50-4" name="__codelineno-50-4" href="#__codelineno-50-4"></a><span class="k">-</span><span class="w"> </span>Start processing order
</span><span id="__codeline__-50-5"><a id="__codelineno-50-5" name="__codelineno-50-5" href="#__codelineno-50-5"></a>
</span><span id="__codeline__-50-6"><a id="__codelineno-50-6" name="__codelineno-50-6" href="#__codelineno-50-6"></a><span class="gu">## GetOrderDetails</span>
</span><span id="__codeline__-50-7"><a id="__codelineno-50-7" name="__codelineno-50-7" href="#__codelineno-50-7"></a><span class="gu">### Triggers</span>
</span><span id="__codeline__-50-8"><a id="__codelineno-50-8" name="__codelineno-50-8" href="#__codelineno-50-8"></a><span class="k">-</span><span class="w"> </span>After starting to process order
</span><span id="__codeline__-50-9"><a id="__codelineno-50-9" name="__codelineno-50-9" href="#__codelineno-50-9"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-50-10"><a id="__codelineno-50-10" name="__codelineno-50-10" href="#__codelineno-50-10"></a><span class="k">-</span><span class="w"> </span>Fetch order from database
</span><span id="__codeline__-50-11"><a id="__codelineno-50-11" name="__codelineno-50-11" href="#__codelineno-50-11"></a>
</span><span id="__codeline__-50-12"><a id="__codelineno-50-12" name="__codelineno-50-12" href="#__codelineno-50-12"></a>&lt;!-- GOOD: Explicit call is clearer --&gt;
</span><span id="__codeline__-50-13"><a id="__codelineno-50-13" name="__codelineno-50-13" href="#__codelineno-50-13"></a><span class="gu">## Main</span>
</span><span id="__codeline__-50-14"><a id="__codelineno-50-14" name="__codelineno-50-14" href="#__codelineno-50-14"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-50-15"><a id="__codelineno-50-15" name="__codelineno-50-15" href="#__codelineno-50-15"></a><span class="k">-</span><span class="w"> </span>Get order details from database
</span><span id="__codeline__-50-16"><a id="__codelineno-50-16" name="__codelineno-50-16" href="#__codelineno-50-16"></a><span class="k">-</span><span class="w"> </span>Process the order
</span></code></pre></div>
<p><strong>Don't use triggers for simple one-off checks</strong>:</p>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-51-1"><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a>&lt;!-- BAD: Unnecessary trigger --&gt;
</span><span id="__codeline__-51-2"><a id="__codelineno-51-2" name="__codelineno-51-2" href="#__codelineno-51-2"></a><span class="gu">## Main</span>
</span><span id="__codeline__-51-3"><a id="__codelineno-51-3" name="__codelineno-51-3" href="#__codelineno-51-3"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-51-4"><a id="__codelineno-51-4" name="__codelineno-51-4" href="#__codelineno-51-4"></a><span class="k">-</span><span class="w"> </span>Ask user for $age
</span><span id="__codeline__-51-5"><a id="__codelineno-51-5" name="__codelineno-51-5" href="#__codelineno-51-5"></a>
</span><span id="__codeline__-51-6"><a id="__codelineno-51-6" name="__codelineno-51-6" href="#__codelineno-51-6"></a><span class="gu">## CheckAge</span>
</span><span id="__codeline__-51-7"><a id="__codelineno-51-7" name="__codelineno-51-7" href="#__codelineno-51-7"></a><span class="gu">### Triggers</span>
</span><span id="__codeline__-51-8"><a id="__codelineno-51-8" name="__codelineno-51-8" href="#__codelineno-51-8"></a><span class="k">-</span><span class="w"> </span>When user provides age
</span><span id="__codeline__-51-9"><a id="__codelineno-51-9" name="__codelineno-51-9" href="#__codelineno-51-9"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-51-10"><a id="__codelineno-51-10" name="__codelineno-51-10" href="#__codelineno-51-10"></a><span class="k">-</span><span class="w"> </span>If $age &lt; 18
</span><span id="__codeline__-51-11"><a id="__codelineno-51-11" name="__codelineno-51-11" href="#__codelineno-51-11"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Tell user must be 18 or older
</span><span id="__codeline__-51-12"><a id="__codelineno-51-12" name="__codelineno-51-12" href="#__codelineno-51-12"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>End program
</span><span id="__codeline__-51-13"><a id="__codelineno-51-13" name="__codelineno-51-13" href="#__codelineno-51-13"></a>
</span><span id="__codeline__-51-14"><a id="__codelineno-51-14" name="__codelineno-51-14" href="#__codelineno-51-14"></a>&lt;!-- GOOD: Inline the check --&gt;
</span><span id="__codeline__-51-15"><a id="__codelineno-51-15" name="__codelineno-51-15" href="#__codelineno-51-15"></a><span class="gu">## Main</span>
</span><span id="__codeline__-51-16"><a id="__codelineno-51-16" name="__codelineno-51-16" href="#__codelineno-51-16"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-51-17"><a id="__codelineno-51-17" name="__codelineno-51-17" href="#__codelineno-51-17"></a><span class="k">-</span><span class="w"> </span>Ask user for $age
</span><span id="__codeline__-51-18"><a id="__codelineno-51-18" name="__codelineno-51-18" href="#__codelineno-51-18"></a><span class="k">-</span><span class="w"> </span>If $age &lt; 18
</span><span id="__codeline__-51-19"><a id="__codelineno-51-19" name="__codelineno-51-19" href="#__codelineno-51-19"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Tell user must be 18 or older
</span><span id="__codeline__-51-20"><a id="__codelineno-51-20" name="__codelineno-51-20" href="#__codelineno-51-20"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>End program
</span><span id="__codeline__-51-21"><a id="__codelineno-51-21" name="__codelineno-51-21" href="#__codelineno-51-21"></a><span class="k">-</span><span class="w"> </span>Continue with adult content
</span></code></pre></div>
<p><strong>Don't overuse triggers</strong>:</p>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-52-1"><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a>&lt;!-- BAD: Too many triggers creates &quot;magic&quot; behavior --&gt;
</span><span id="__codeline__-52-2"><a id="__codelineno-52-2" name="__codelineno-52-2" href="#__codelineno-52-2"></a><span class="gu">## Main</span>
</span><span id="__codeline__-52-3"><a id="__codelineno-52-3" name="__codelineno-52-3" href="#__codelineno-52-3"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-52-4"><a id="__codelineno-52-4" name="__codelineno-52-4" href="#__codelineno-52-4"></a><span class="k">-</span><span class="w"> </span>Start the workflow
</span><span id="__codeline__-52-5"><a id="__codelineno-52-5" name="__codelineno-52-5" href="#__codelineno-52-5"></a>
</span><span id="__codeline__-52-6"><a id="__codelineno-52-6" name="__codelineno-52-6" href="#__codelineno-52-6"></a><span class="gu">## Step1</span>
</span><span id="__codeline__-52-7"><a id="__codelineno-52-7" name="__codelineno-52-7" href="#__codelineno-52-7"></a><span class="gu">### Triggers</span>
</span><span id="__codeline__-52-8"><a id="__codelineno-52-8" name="__codelineno-52-8" href="#__codelineno-52-8"></a><span class="k">-</span><span class="w"> </span>When workflow starts
</span><span id="__codeline__-52-9"><a id="__codelineno-52-9" name="__codelineno-52-9" href="#__codelineno-52-9"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-52-10"><a id="__codelineno-52-10" name="__codelineno-52-10" href="#__codelineno-52-10"></a><span class="k">-</span><span class="w"> </span>Do step 1
</span><span id="__codeline__-52-11"><a id="__codelineno-52-11" name="__codelineno-52-11" href="#__codelineno-52-11"></a>
</span><span id="__codeline__-52-12"><a id="__codelineno-52-12" name="__codelineno-52-12" href="#__codelineno-52-12"></a><span class="gu">## Step2</span>
</span><span id="__codeline__-52-13"><a id="__codelineno-52-13" name="__codelineno-52-13" href="#__codelineno-52-13"></a><span class="gu">### Triggers</span>
</span><span id="__codeline__-52-14"><a id="__codelineno-52-14" name="__codelineno-52-14" href="#__codelineno-52-14"></a><span class="k">-</span><span class="w"> </span>After step 1 completes
</span><span id="__codeline__-52-15"><a id="__codelineno-52-15" name="__codelineno-52-15" href="#__codelineno-52-15"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-52-16"><a id="__codelineno-52-16" name="__codelineno-52-16" href="#__codelineno-52-16"></a><span class="k">-</span><span class="w"> </span>Do step 2
</span><span id="__codeline__-52-17"><a id="__codelineno-52-17" name="__codelineno-52-17" href="#__codelineno-52-17"></a>
</span><span id="__codeline__-52-18"><a id="__codelineno-52-18" name="__codelineno-52-18" href="#__codelineno-52-18"></a><span class="gu">## Step3</span>
</span><span id="__codeline__-52-19"><a id="__codelineno-52-19" name="__codelineno-52-19" href="#__codelineno-52-19"></a><span class="gu">### Triggers</span>
</span><span id="__codeline__-52-20"><a id="__codelineno-52-20" name="__codelineno-52-20" href="#__codelineno-52-20"></a><span class="k">-</span><span class="w"> </span>After step 2 completes
</span><span id="__codeline__-52-21"><a id="__codelineno-52-21" name="__codelineno-52-21" href="#__codelineno-52-21"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-52-22"><a id="__codelineno-52-22" name="__codelineno-52-22" href="#__codelineno-52-22"></a><span class="k">-</span><span class="w"> </span>Do step 3
</span><span id="__codeline__-52-23"><a id="__codelineno-52-23" name="__codelineno-52-23" href="#__codelineno-52-23"></a>
</span><span id="__codeline__-52-24"><a id="__codelineno-52-24" name="__codelineno-52-24" href="#__codelineno-52-24"></a>&lt;!-- GOOD: Explicit sequential flow --&gt;
</span><span id="__codeline__-52-25"><a id="__codelineno-52-25" name="__codelineno-52-25" href="#__codelineno-52-25"></a><span class="gu">## Main</span>
</span><span id="__codeline__-52-26"><a id="__codelineno-52-26" name="__codelineno-52-26" href="#__codelineno-52-26"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-52-27"><a id="__codelineno-52-27" name="__codelineno-52-27" href="#__codelineno-52-27"></a><span class="k">-</span><span class="w"> </span>Do step 1
</span><span id="__codeline__-52-28"><a id="__codelineno-52-28" name="__codelineno-52-28" href="#__codelineno-52-28"></a><span class="k">-</span><span class="w"> </span>Do step 2
</span><span id="__codeline__-52-29"><a id="__codelineno-52-29" name="__codelineno-52-29" href="#__codelineno-52-29"></a><span class="k">-</span><span class="w"> </span>Do step 3
</span></code></pre></div>
<h3 id="trigger-best-practices">Trigger Best Practices<a class="headerlink" href="#trigger-best-practices" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Be specific</strong>: "When user provides email" not "When email"</li>
<li><strong>Avoid conflicts</strong>: Don't create multiple triggers for same condition</li>
<li><strong>Document intent</strong>: Explain why the trigger exists in playbook description</li>
<li><strong>Test edge cases</strong>: What if trigger fires mid-execution?</li>
<li><strong>Keep it simple</strong>: If you have more than 3-4 triggers total, reconsider your design</li>
<li><strong>Prefer explicit</strong>: When in doubt, use explicit function calls instead of triggers</li>
</ol>
<hr />
<h2 id="description-placeholders">Description Placeholders<a class="headerlink" href="#description-placeholders" title="Permanent link">&para;</a></h2>
<p>Inject dynamic content into playbook descriptions using <code>{expression}</code> syntax.</p>
<h3 id="basic-usage">Basic Usage<a class="headerlink" href="#basic-usage" title="Permanent link">&para;</a></h3>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-53-1"><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a><span class="gu">## ProcessOrder</span>
</span><span id="__codeline__-53-2"><a id="__codelineno-53-2" name="__codelineno-53-2" href="#__codelineno-53-2"></a>Processing order {$order_id} for customer {$customer_name}.
</span><span id="__codeline__-53-3"><a id="__codelineno-53-3" name="__codelineno-53-3" href="#__codelineno-53-3"></a>Today&#39;s date is {date.today().strftime(&quot;%Y-%m-%d&quot;)}.
</span></code></pre></div>
<p>When playbook executes:
<div class="language-text highlight"><pre><span></span><code><span id="__codeline__-54-1"><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a>Processing order 12345 for customer Alice Smith.
</span><span id="__codeline__-54-2"><a id="__codelineno-54-2" name="__codelineno-54-2" href="#__codelineno-54-2"></a>Today&#39;s date is 2025-10-06.
</span></code></pre></div></p>
<h3 id="what-you-can-use">What You Can Use<a class="headerlink" href="#what-you-can-use" title="Permanent link">&para;</a></h3>
<p><strong>Variables</strong>:</p>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-55-1"><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a><span class="gu">## ReviewTransaction</span>
</span><span id="__codeline__-55-2"><a id="__codelineno-55-2" name="__codelineno-55-2" href="#__codelineno-55-2"></a>Transaction {$transaction_id} with amount ${$amount}
</span></code></pre></div>
<p><strong>Playbook Calls</strong>:</p>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-56-1"><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a><span class="gu">## AnswerQuestions  </span>
</span><span id="__codeline__-56-2"><a id="__codelineno-56-2" name="__codelineno-56-2" href="#__codelineno-56-2"></a>Q1 Summary: {QuarterlySummary(&quot;Q1&quot;)}
</span><span id="__codeline__-56-3"><a id="__codelineno-56-3" name="__codelineno-56-3" href="#__codelineno-56-3"></a>Q2 Summary: {QuarterlySummary(&quot;Q2&quot;)}
</span><span id="__codeline__-56-4"><a id="__codelineno-56-4" name="__codelineno-56-4" href="#__codelineno-56-4"></a>
</span><span id="__codeline__-56-5"><a id="__codelineno-56-5" name="__codelineno-56-5" href="#__codelineno-56-5"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-56-6"><a id="__codelineno-56-6" name="__codelineno-56-6" href="#__codelineno-56-6"></a><span class="k">-</span><span class="w"> </span>Answer questions based on summaries above
</span></code></pre></div>
<p><strong>Python Expressions</strong>:</p>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-57-1"><a id="__codelineno-57-1" name="__codelineno-57-1" href="#__codelineno-57-1"></a><span class="gu">## AnalyzePerformance</span>
</span><span id="__codeline__-57-2"><a id="__codelineno-57-2" name="__codelineno-57-2" href="#__codelineno-57-2"></a>Score: {round($score * 100, 2)}%
</span><span id="__codeline__-57-3"><a id="__codelineno-57-3" name="__codelineno-57-3" href="#__codelineno-57-3"></a>Status: {&quot;Excellent&quot; if $score &gt; 0.9 else &quot;Good&quot;}
</span><span id="__codeline__-57-4"><a id="__codelineno-57-4" name="__codelineno-57-4" href="#__codelineno-57-4"></a>Timestamp: {timestamp.strftime(&quot;%Y-%m-%d %H:%M&quot;)}
</span></code></pre></div>
<p><strong>Special Variables</strong>:</p>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-58-1"><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a><span class="gu">## Debug</span>
</span><span id="__codeline__-58-2"><a id="__codelineno-58-2" name="__codelineno-58-2" href="#__codelineno-58-2"></a>Current agent: {agent.klass}
</span><span id="__codeline__-58-3"><a id="__codelineno-58-3" name="__codelineno-58-3" href="#__codelineno-58-3"></a>Playbook: {call.playbook_name}
</span><span id="__codeline__-58-4"><a id="__codelineno-58-4" name="__codelineno-58-4" href="#__codelineno-58-4"></a>Current time: {timestamp}
</span></code></pre></div>
<h3 id="common-patterns">Common Patterns<a class="headerlink" href="#common-patterns" title="Permanent link">&para;</a></h3>
<p><strong>Contextual Dates</strong>:</p>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-59-1"><a id="__codelineno-59-1" name="__codelineno-59-1" href="#__codelineno-59-1"></a><span class="gu">## SummarizeOrder($order)</span>
</span><span id="__codeline__-59-2"><a id="__codelineno-59-2" name="__codelineno-59-2" href="#__codelineno-59-2"></a>Summarize order considering today is {date.today().strftime(&quot;%Y-%m-%d&quot;)}
</span><span id="__codeline__-59-3"><a id="__codelineno-59-3" name="__codelineno-59-3" href="#__codelineno-59-3"></a>
</span><span id="__codeline__-59-4"><a id="__codelineno-59-4" name="__codelineno-59-4" href="#__codelineno-59-4"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-59-5"><a id="__codelineno-59-5" name="__codelineno-59-5" href="#__codelineno-59-5"></a><span class="k">-</span><span class="w"> </span>If order is overdue
</span><span id="__codeline__-59-6"><a id="__codelineno-59-6" name="__codelineno-59-6" href="#__codelineno-59-6"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Apologize for delay
</span></code></pre></div>
<p><strong>Dynamic Lists</strong>:</p>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-60-1"><a id="__codelineno-60-1" name="__codelineno-60-1" href="#__codelineno-60-1"></a><span class="gu">## ProcessItems</span>
</span><span id="__codeline__-60-2"><a id="__codelineno-60-2" name="__codelineno-60-2" href="#__codelineno-60-2"></a>Items to process:
</span><span id="__codeline__-60-3"><a id="__codelineno-60-3" name="__codelineno-60-3" href="#__codelineno-60-3"></a>{chr(10).join(f&quot;- {item}&quot; for item in $items)}
</span><span id="__codeline__-60-4"><a id="__codelineno-60-4" name="__codelineno-60-4" href="#__codelineno-60-4"></a>
</span><span id="__codeline__-60-5"><a id="__codelineno-60-5" name="__codelineno-60-5" href="#__codelineno-60-5"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-60-6"><a id="__codelineno-60-6" name="__codelineno-60-6" href="#__codelineno-60-6"></a><span class="k">-</span><span class="w"> </span>Process each item
</span></code></pre></div>
<p><strong>Conditional Context</strong>:</p>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-61-1"><a id="__codelineno-61-1" name="__codelineno-61-1" href="#__codelineno-61-1"></a><span class="gu">## CustomerService</span>
</span><span id="__codeline__-61-2"><a id="__codelineno-61-2" name="__codelineno-61-2" href="#__codelineno-61-2"></a>{&quot;Customer is VIP - provide premium service&quot; if $customer.tier == &quot;VIP&quot; else &quot;&quot;}
</span></code></pre></div>
<h3 id="best-practices">Best Practices<a class="headerlink" href="#best-practices" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Evaluate once</strong>: Placeholders resolved when playbook starts, not re-evaluated</li>
<li><strong>Keep simple</strong>: Complex logic belongs in Python playbooks</li>
<li><strong>Import dependencies</strong>: <code>from datetime import date</code> in Python block if needed</li>
<li><strong>Security</strong>: No <code>eval</code>, <code>exec</code>, <code>subprocess</code>, <code>__import__</code></li>
</ol>
<hr />
<h2 id="artifacts-and-memory">Artifacts and Memory<a class="headerlink" href="#artifacts-and-memory" title="Permanent link">&para;</a></h2>
<h3 id="artifacts-persistent-files-alpha-feature">Artifacts - Persistent Files (alpha feature)<a class="headerlink" href="#artifacts-persistent-files-alpha-feature" title="Permanent link">&para;</a></h3>
<p>Artifacts are named content that persists across playbook calls.</p>
<p><strong>Save Artifact</strong>:</p>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-62-1"><a id="__codelineno-62-1" name="__codelineno-62-1" href="#__codelineno-62-1"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-62-2"><a id="__codelineno-62-2" name="__codelineno-62-2" href="#__codelineno-62-2"></a><span class="k">-</span><span class="w"> </span>Create report content
</span><span id="__codeline__-62-3"><a id="__codelineno-62-3" name="__codelineno-62-3" href="#__codelineno-62-3"></a><span class="k">-</span><span class="w"> </span>SaveArtifact(&quot;report.md&quot;, &quot;Monthly Report&quot;, $report_content)
</span><span id="__codeline__-62-4"><a id="__codelineno-62-4" name="__codelineno-62-4" href="#__codelineno-62-4"></a><span class="k">-</span><span class="w"> </span>Tell user &quot;Report saved as Artifact[report.md]&quot;
</span></code></pre></div>
<p><strong>Load Artifact</strong>:</p>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-63-1"><a id="__codelineno-63-1" name="__codelineno-63-1" href="#__codelineno-63-1"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-63-2"><a id="__codelineno-63-2" name="__codelineno-63-2" href="#__codelineno-63-2"></a><span class="k">-</span><span class="w"> </span>LoadArtifact(&quot;report.md&quot;)
</span><span id="__codeline__-63-3"><a id="__codelineno-63-3" name="__codelineno-63-3" href="#__codelineno-63-3"></a><span class="k">-</span><span class="w"> </span>Summarize the loaded report
</span></code></pre></div>
<p><strong>Python Usage</strong>:</p>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-64-1"><a id="__codelineno-64-1" name="__codelineno-64-1" href="#__codelineno-64-1"></a><span class="sb">```python</span>
</span><span id="__codeline__-64-2"><a id="__codelineno-64-2" name="__codelineno-64-2" href="#__codelineno-64-2"></a><span class="nd">@playbook</span>
</span><span id="__codeline__-64-3"><a id="__codelineno-64-3" name="__codelineno-64-3" href="#__codelineno-64-3"></a><span class="k">async</span> <span class="k">def</span> <span class="nf">GenerateReport</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__codeline__-64-4"><a id="__codelineno-64-4" name="__codelineno-64-4" href="#__codelineno-64-4"></a>    <span class="n">report</span> <span class="o">=</span> <span class="n">format_report</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="__codeline__-64-5"><a id="__codelineno-64-5" name="__codelineno-64-5" href="#__codelineno-64-5"></a>    <span class="k">await</span> <span class="n">SaveArtifact</span><span class="p">(</span><span class="s2">&quot;report.md&quot;</span><span class="p">,</span> <span class="s2">&quot;Sales Report&quot;</span><span class="p">,</span> <span class="n">report</span><span class="p">)</span>
</span><span id="__codeline__-64-6"><a id="__codelineno-64-6" name="__codelineno-64-6" href="#__codelineno-64-6"></a>    <span class="k">return</span> <span class="s2">&quot;Artifact[report.md]&quot;</span>
</span><span id="__codeline__-64-7"><a id="__codelineno-64-7" name="__codelineno-64-7" href="#__codelineno-64-7"></a>
</span><span id="__codeline__-64-8"><a id="__codelineno-64-8" name="__codelineno-64-8" href="#__codelineno-64-8"></a><span class="nd">@playbook</span>
</span><span id="__codeline__-64-9"><a id="__codelineno-64-9" name="__codelineno-64-9" href="#__codelineno-64-9"></a><span class="k">async</span> <span class="k">def</span> <span class="nf">AnalyzeReport</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__codeline__-64-10"><a id="__codelineno-64-10" name="__codelineno-64-10" href="#__codelineno-64-10"></a>    <span class="n">artifact</span> <span class="o">=</span> <span class="k">await</span> <span class="n">LoadArtifact</span><span class="p">(</span><span class="s2">&quot;report.md&quot;</span><span class="p">)</span>
</span><span id="__codeline__-64-11"><a id="__codelineno-64-11" name="__codelineno-64-11" href="#__codelineno-64-11"></a>    <span class="c1"># artifact.name, artifact.description, artifact.content</span>
</span><span id="__codeline__-64-12"><a id="__codelineno-64-12" name="__codelineno-64-12" href="#__codelineno-64-12"></a>    <span class="k">return</span> <span class="n">analysis</span>
</span><span id="__codeline__-64-13"><a id="__codelineno-64-13" name="__codelineno-64-13" href="#__codelineno-64-13"></a><span class="sb">```</span>
</span></code></pre></div>
<h3 id="when-to-use-artifacts">When to Use Artifacts<a class="headerlink" href="#when-to-use-artifacts" title="Permanent link">&para;</a></h3>
<ul>
<li>✅ Large content (reports, documents, datasets)</li>
<li>✅ Content referenced multiple times</li>
<li>✅ Content persists across conversation</li>
<li>✅ User needs to download/view separately</li>
</ul>
<hr />
<h2 id="common-patterns-and-best-practices">Common Patterns and Best Practices<a class="headerlink" href="#common-patterns-and-best-practices" title="Permanent link">&para;</a></h2>
<h3 id="pattern-conversational-input-collection">Pattern: Conversational Input Collection<a class="headerlink" href="#pattern-conversational-input-collection" title="Permanent link">&para;</a></h3>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-65-1"><a id="__codelineno-65-1" name="__codelineno-65-1" href="#__codelineno-65-1"></a><span class="gu">## Main</span>
</span><span id="__codeline__-65-2"><a id="__codelineno-65-2" name="__codelineno-65-2" href="#__codelineno-65-2"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-65-3"><a id="__codelineno-65-3" name="__codelineno-65-3" href="#__codelineno-65-3"></a><span class="k">-</span><span class="w"> </span>Ask user for their $email
</span><span id="__codeline__-65-4"><a id="__codelineno-65-4" name="__codelineno-65-4" href="#__codelineno-65-4"></a><span class="k">-</span><span class="w"> </span>Engage in conversation if needed without being pushy
</span><span id="__codeline__-65-5"><a id="__codelineno-65-5" name="__codelineno-65-5" href="#__codelineno-65-5"></a><span class="k">-</span><span class="w"> </span>Once $email is provided, continue
</span></code></pre></div>
<p>This pattern:</p>
<ul>
<li>Asks for information</li>
<li>Handles small talk gracefully</li>
<li>Doesn't rudely demand input</li>
<li>Continues when criteria met</li>
</ul>
<h3 id="pattern-validation-with-triggers">Pattern: Validation with Triggers<a class="headerlink" href="#pattern-validation-with-triggers" title="Permanent link">&para;</a></h3>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-66-1"><a id="__codelineno-66-1" name="__codelineno-66-1" href="#__codelineno-66-1"></a><span class="gu">## Main</span>
</span><span id="__codeline__-66-2"><a id="__codelineno-66-2" name="__codelineno-66-2" href="#__codelineno-66-2"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-66-3"><a id="__codelineno-66-3" name="__codelineno-66-3" href="#__codelineno-66-3"></a><span class="k">-</span><span class="w"> </span>Ask user for their $pin
</span><span id="__codeline__-66-4"><a id="__codelineno-66-4" name="__codelineno-66-4" href="#__codelineno-66-4"></a><span class="k">-</span><span class="w"> </span>Continue once $pin is valid
</span><span id="__codeline__-66-5"><a id="__codelineno-66-5" name="__codelineno-66-5" href="#__codelineno-66-5"></a>
</span><span id="__codeline__-66-6"><a id="__codelineno-66-6" name="__codelineno-66-6" href="#__codelineno-66-6"></a><span class="gu">## ValidatePIN</span>
</span><span id="__codeline__-66-7"><a id="__codelineno-66-7" name="__codelineno-66-7" href="#__codelineno-66-7"></a><span class="gu">### Triggers</span>
</span><span id="__codeline__-66-8"><a id="__codelineno-66-8" name="__codelineno-66-8" href="#__codelineno-66-8"></a><span class="k">-</span><span class="w"> </span>When user provides PIN
</span><span id="__codeline__-66-9"><a id="__codelineno-66-9" name="__codelineno-66-9" href="#__codelineno-66-9"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-66-10"><a id="__codelineno-66-10" name="__codelineno-66-10" href="#__codelineno-66-10"></a><span class="k">-</span><span class="w"> </span>If $pin is not 4 digits
</span><span id="__codeline__-66-11"><a id="__codelineno-66-11" name="__codelineno-66-11" href="#__codelineno-66-11"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Tell user PIN must be 4 digits
</span><span id="__codeline__-66-12"><a id="__codelineno-66-12" name="__codelineno-66-12" href="#__codelineno-66-12"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Ask for PIN again
</span></code></pre></div>
<h3 id="pattern-python-markdown-composition">Pattern: Python ↔ Markdown Composition<a class="headerlink" href="#pattern-python-markdown-composition" title="Permanent link">&para;</a></h3>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-67-1"><a id="__codelineno-67-1" name="__codelineno-67-1" href="#__codelineno-67-1"></a><span class="sb">```python</span>
</span><span id="__codeline__-67-2"><a id="__codelineno-67-2" name="__codelineno-67-2" href="#__codelineno-67-2"></a><span class="nd">@playbook</span>
</span><span id="__codeline__-67-3"><a id="__codelineno-67-3" name="__codelineno-67-3" href="#__codelineno-67-3"></a><span class="k">async</span> <span class="k">def</span> <span class="nf">FetchData</span><span class="p">(</span><span class="nb">id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__codeline__-67-4"><a id="__codelineno-67-4" name="__codelineno-67-4" href="#__codelineno-67-4"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get data from external API.&quot;&quot;&quot;</span>
</span><span id="__codeline__-67-5"><a id="__codelineno-67-5" name="__codelineno-67-5" href="#__codelineno-67-5"></a>    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;https://api.example.com/data/</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__codeline__-67-6"><a id="__codelineno-67-6" name="__codelineno-67-6" href="#__codelineno-67-6"></a>    <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</span><span id="__codeline__-67-7"><a id="__codelineno-67-7" name="__codelineno-67-7" href="#__codelineno-67-7"></a>
</span><span id="__codeline__-67-8"><a id="__codelineno-67-8" name="__codelineno-67-8" href="#__codelineno-67-8"></a><span class="nd">@playbook</span>
</span><span id="__codeline__-67-9"><a id="__codelineno-67-9" name="__codelineno-67-9" href="#__codelineno-67-9"></a><span class="k">async</span> <span class="k">def</span> <span class="nf">ProcessItem</span><span class="p">(</span><span class="n">item</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="__codeline__-67-10"><a id="__codelineno-67-10" name="__codelineno-67-10" href="#__codelineno-67-10"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Process item and generate summary.&quot;&quot;&quot;</span>
</span><span id="__codeline__-67-11"><a id="__codelineno-67-11" name="__codelineno-67-11" href="#__codelineno-67-11"></a>    <span class="c1"># Complex processing logic</span>
</span><span id="__codeline__-67-12"><a id="__codelineno-67-12" name="__codelineno-67-12" href="#__codelineno-67-12"></a>    <span class="n">summary</span> <span class="o">=</span> <span class="k">await</span> <span class="n">SummarizeItem</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>  <span class="c1"># Call Markdown playbook</span>
</span><span id="__codeline__-67-13"><a id="__codelineno-67-13" name="__codelineno-67-13" href="#__codelineno-67-13"></a>    <span class="k">return</span> <span class="n">summary</span>
</span><span id="__codeline__-67-14"><a id="__codelineno-67-14" name="__codelineno-67-14" href="#__codelineno-67-14"></a><span class="sb">```</span>
</span><span id="__codeline__-67-15"><a id="__codelineno-67-15" name="__codelineno-67-15" href="#__codelineno-67-15"></a>
</span><span id="__codeline__-67-16"><a id="__codelineno-67-16" name="__codelineno-67-16" href="#__codelineno-67-16"></a><span class="gu">## SummarizeItem($item)</span>
</span><span id="__codeline__-67-17"><a id="__codelineno-67-17" name="__codelineno-67-17" href="#__codelineno-67-17"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-67-18"><a id="__codelineno-67-18" name="__codelineno-67-18" href="#__codelineno-67-18"></a><span class="k">-</span><span class="w"> </span>Extract key fields from $item
</span><span id="__codeline__-67-19"><a id="__codelineno-67-19" name="__codelineno-67-19" href="#__codelineno-67-19"></a><span class="k">-</span><span class="w"> </span>Format as user-friendly summary
</span><span id="__codeline__-67-20"><a id="__codelineno-67-20" name="__codelineno-67-20" href="#__codelineno-67-20"></a><span class="k">-</span><span class="w"> </span>Return summary
</span></code></pre></div>
<h3 id="pattern-batch-operations">Pattern: Batch Operations<a class="headerlink" href="#pattern-batch-operations" title="Permanent link">&para;</a></h3>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-68-1"><a id="__codelineno-68-1" name="__codelineno-68-1" href="#__codelineno-68-1"></a><span class="gu">## ProcessOrders</span>
</span><span id="__codeline__-68-2"><a id="__codelineno-68-2" name="__codelineno-68-2" href="#__codelineno-68-2"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-68-3"><a id="__codelineno-68-3" name="__codelineno-68-3" href="#__codelineno-68-3"></a><span class="k">-</span><span class="w"> </span>Get list of $pending_orders from database
</span><span id="__codeline__-68-4"><a id="__codelineno-68-4" name="__codelineno-68-4" href="#__codelineno-68-4"></a><span class="k">-</span><span class="w"> </span>For each $order in $pending_orders
</span><span id="__codeline__-68-5"><a id="__codelineno-68-5" name="__codelineno-68-5" href="#__codelineno-68-5"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>ProcessSingleOrder($order)
</span><span id="__codeline__-68-6"><a id="__codelineno-68-6" name="__codelineno-68-6" href="#__codelineno-68-6"></a><span class="k">-</span><span class="w"> </span>Tell user all orders processed
</span></code></pre></div>
<h3 id="pattern-error-handling">Pattern: Error Handling<a class="headerlink" href="#pattern-error-handling" title="Permanent link">&para;</a></h3>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-69-1"><a id="__codelineno-69-1" name="__codelineno-69-1" href="#__codelineno-69-1"></a><span class="gu">## SafeOperation</span>
</span><span id="__codeline__-69-2"><a id="__codelineno-69-2" name="__codelineno-69-2" href="#__codelineno-69-2"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-69-3"><a id="__codelineno-69-3" name="__codelineno-69-3" href="#__codelineno-69-3"></a><span class="k">-</span><span class="w"> </span>Try to process $data
</span><span id="__codeline__-69-4"><a id="__codelineno-69-4" name="__codelineno-69-4" href="#__codelineno-69-4"></a><span class="k">-</span><span class="w"> </span>If operation fails
</span><span id="__codeline__-69-5"><a id="__codelineno-69-5" name="__codelineno-69-5" href="#__codelineno-69-5"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Log error
</span><span id="__codeline__-69-6"><a id="__codelineno-69-6" name="__codelineno-69-6" href="#__codelineno-69-6"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Tell user operation failed with reason
</span><span id="__codeline__-69-7"><a id="__codelineno-69-7" name="__codelineno-69-7" href="#__codelineno-69-7"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Return error status
</span><span id="__codeline__-69-8"><a id="__codelineno-69-8" name="__codelineno-69-8" href="#__codelineno-69-8"></a><span class="k">-</span><span class="w"> </span>Otherwise
</span><span id="__codeline__-69-9"><a id="__codelineno-69-9" name="__codelineno-69-9" href="#__codelineno-69-9"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Tell user success
</span><span id="__codeline__-69-10"><a id="__codelineno-69-10" name="__codelineno-69-10" href="#__codelineno-69-10"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Return success status
</span></code></pre></div>
<h3 id="pattern-meeting-facilitation">Pattern: Meeting Facilitation<a class="headerlink" href="#pattern-meeting-facilitation" title="Permanent link">&para;</a></h3>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-70-1"><a id="__codelineno-70-1" name="__codelineno-70-1" href="#__codelineno-70-1"></a><span class="gu">## ProjectPlanningMeeting</span>
</span><span id="__codeline__-70-2"><a id="__codelineno-70-2" name="__codelineno-70-2" href="#__codelineno-70-2"></a>meeting: true
</span><span id="__codeline__-70-3"><a id="__codelineno-70-3" name="__codelineno-70-3" href="#__codelineno-70-3"></a>required_attendees: [Developer, Designer, ProductManager]
</span><span id="__codeline__-70-4"><a id="__codelineno-70-4" name="__codelineno-70-4" href="#__codelineno-70-4"></a>
</span><span id="__codeline__-70-5"><a id="__codelineno-70-5" name="__codelineno-70-5" href="#__codelineno-70-5"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-70-6"><a id="__codelineno-70-6" name="__codelineno-70-6" href="#__codelineno-70-6"></a><span class="k">-</span><span class="w"> </span>Welcome everyone and state meeting goal
</span><span id="__codeline__-70-7"><a id="__codelineno-70-7" name="__codelineno-70-7" href="#__codelineno-70-7"></a><span class="k">-</span><span class="w"> </span>Explain agenda and time limit
</span><span id="__codeline__-70-8"><a id="__codelineno-70-8" name="__codelineno-70-8" href="#__codelineno-70-8"></a><span class="k">-</span><span class="w"> </span>Set $max_turns to 20
</span><span id="__codeline__-70-9"><a id="__codelineno-70-9" name="__codelineno-70-9" href="#__codelineno-70-9"></a><span class="k">-</span><span class="w"> </span>Set $turn_count to 0
</span><span id="__codeline__-70-10"><a id="__codelineno-70-10" name="__codelineno-70-10" href="#__codelineno-70-10"></a><span class="k">-</span><span class="w"> </span>While meeting active and $turn_count &lt; $max_turns
</span><span id="__codeline__-70-11"><a id="__codelineno-70-11" name="__codelineno-70-11" href="#__codelineno-70-11"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Facilitate discussion
</span><span id="__codeline__-70-12"><a id="__codelineno-70-12" name="__codelineno-70-12" href="#__codelineno-70-12"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Increment $turn_count
</span><span id="__codeline__-70-13"><a id="__codelineno-70-13" name="__codelineno-70-13" href="#__codelineno-70-13"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Keep discussion on track
</span><span id="__codeline__-70-14"><a id="__codelineno-70-14" name="__codelineno-70-14" href="#__codelineno-70-14"></a><span class="k">-</span><span class="w"> </span>If consensus reached
</span><span id="__codeline__-70-15"><a id="__codelineno-70-15" name="__codelineno-70-15" href="#__codelineno-70-15"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Summarize decisions
</span><span id="__codeline__-70-16"><a id="__codelineno-70-16" name="__codelineno-70-16" href="#__codelineno-70-16"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Assign action items
</span><span id="__codeline__-70-17"><a id="__codelineno-70-17" name="__codelineno-70-17" href="#__codelineno-70-17"></a><span class="k">-</span><span class="w"> </span>End meeting
</span><span id="__codeline__-70-18"><a id="__codelineno-70-18" name="__codelineno-70-18" href="#__codelineno-70-18"></a><span class="k">-</span><span class="w"> </span>Return meeting summary
</span></code></pre></div>
<h3 id="pattern-collecting-inputs-from-user">Pattern: Collecting Inputs from User<a class="headerlink" href="#pattern-collecting-inputs-from-user" title="Permanent link">&para;</a></h3>
<p>When your agent needs information from the user, always ask for all inputs at once and establish a clear conversation loop until all valid data is acquired:</p>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-71-1"><a id="__codelineno-71-1" name="__codelineno-71-1" href="#__codelineno-71-1"></a><span class="gu">## Main</span>
</span><span id="__codeline__-71-2"><a id="__codelineno-71-2" name="__codelineno-71-2" href="#__codelineno-71-2"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-71-3"><a id="__codelineno-71-3" name="__codelineno-71-3" href="#__codelineno-71-3"></a><span class="k">-</span><span class="w"> </span>Ask user for $email and $pin, engage in a conversation till user provides valid values or gives up
</span><span id="__codeline__-71-4"><a id="__codelineno-71-4" name="__codelineno-71-4" href="#__codelineno-71-4"></a><span class="k">-</span><span class="w"> </span>If user gives up, apologize and return
</span><span id="__codeline__-71-5"><a id="__codelineno-71-5" name="__codelineno-71-5" href="#__codelineno-71-5"></a><span class="k">-</span><span class="w"> </span>Inform user that you were able to authenticate them
</span></code></pre></div>
<p>This pattern:</p>
<ul>
<li><strong>Asks for all required information upfront</strong> - more efficient for the user</li>
<li><strong>Includes a clear termination condition</strong> - handles the case where user wants to exit</li>
<li><strong>Validates both inputs before proceeding</strong> - ensures data quality</li>
<li><strong>Avoids sequential asking</strong> - better user experience than asking one at a time</li>
</ul>
<p><strong>Why this matters</strong>: Asking for information piece by piece creates a poor user experience. Users appreciate knowing all requirements upfront.</p>
<h3 id="pattern-mock-backend-interactions-with-python-playbooks">Pattern: Mock Backend Interactions with Python Playbooks<a class="headerlink" href="#pattern-mock-backend-interactions-with-python-playbooks" title="Permanent link">&para;</a></h3>
<p>Think if a certain action would require backend interaction (databases, APIs, authentication services). If so, use Python playbooks to encapsulate that logic. Use mock implementations as necessary to aid in development:</p>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-72-1"><a id="__codelineno-72-1" name="__codelineno-72-1" href="#__codelineno-72-1"></a><span class="sb">```python</span>
</span><span id="__codeline__-72-2"><a id="__codelineno-72-2" name="__codelineno-72-2" href="#__codelineno-72-2"></a><span class="nd">@playbook</span>
</span><span id="__codeline__-72-3"><a id="__codelineno-72-3" name="__codelineno-72-3" href="#__codelineno-72-3"></a><span class="k">async</span> <span class="k">def</span> <span class="nf">AuthenticateUser</span><span class="p">(</span><span class="err">$</span><span class="n">email</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="err">$</span><span class="n">pin</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__codeline__-72-4"><a id="__codelineno-72-4" name="__codelineno-72-4" href="#__codelineno-72-4"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Authenticate user with email and PIN.</span>
</span><span id="__codeline__-72-5"><a id="__codelineno-72-5" name="__codelineno-72-5" href="#__codelineno-72-5"></a>
</span><span id="__codeline__-72-6"><a id="__codelineno-72-6" name="__codelineno-72-6" href="#__codelineno-72-6"></a><span class="sd">    In production, this would call the actual authentication service.</span>
</span><span id="__codeline__-72-7"><a id="__codelineno-72-7" name="__codelineno-72-7" href="#__codelineno-72-7"></a><span class="sd">    For now, using mock data for development.</span>
</span><span id="__codeline__-72-8"><a id="__codelineno-72-8" name="__codelineno-72-8" href="#__codelineno-72-8"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__codeline__-72-9"><a id="__codelineno-72-9" name="__codelineno-72-9" href="#__codelineno-72-9"></a>    <span class="c1"># Mock implementation for development</span>
</span><span id="__codeline__-72-10"><a id="__codelineno-72-10" name="__codelineno-72-10" href="#__codelineno-72-10"></a>    <span class="k">return</span> <span class="err">$</span><span class="n">email</span> <span class="o">==</span> <span class="s2">&quot;test@test.com&quot;</span> <span class="ow">and</span> <span class="err">$</span><span class="n">pin</span> <span class="o">==</span> <span class="s2">&quot;1234&quot;</span>
</span><span id="__codeline__-72-11"><a id="__codelineno-72-11" name="__codelineno-72-11" href="#__codelineno-72-11"></a>
</span><span id="__codeline__-72-12"><a id="__codelineno-72-12" name="__codelineno-72-12" href="#__codelineno-72-12"></a><span class="nd">@playbook</span>  
</span><span id="__codeline__-72-13"><a id="__codelineno-72-13" name="__codelineno-72-13" href="#__codelineno-72-13"></a><span class="k">async</span> <span class="k">def</span> <span class="nf">FetchUserProfile</span><span class="p">(</span><span class="err">$</span><span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__codeline__-72-14"><a id="__codelineno-72-14" name="__codelineno-72-14" href="#__codelineno-72-14"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Fetch user profile from database.</span>
</span><span id="__codeline__-72-15"><a id="__codelineno-72-15" name="__codelineno-72-15" href="#__codelineno-72-15"></a>
</span><span id="__codeline__-72-16"><a id="__codelineno-72-16" name="__codelineno-72-16" href="#__codelineno-72-16"></a><span class="sd">    Production: Query user database</span>
</span><span id="__codeline__-72-17"><a id="__codelineno-72-17" name="__codelineno-72-17" href="#__codelineno-72-17"></a><span class="sd">    Development: Return mock data</span>
</span><span id="__codeline__-72-18"><a id="__codelineno-72-18" name="__codelineno-72-18" href="#__codelineno-72-18"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__codeline__-72-19"><a id="__codelineno-72-19" name="__codelineno-72-19" href="#__codelineno-72-19"></a>    <span class="c1"># Mock implementation</span>
</span><span id="__codeline__-72-20"><a id="__codelineno-72-20" name="__codelineno-72-20" href="#__codelineno-72-20"></a>    <span class="k">return</span> <span class="p">{</span>
</span><span id="__codeline__-72-21"><a id="__codelineno-72-21" name="__codelineno-72-21" href="#__codelineno-72-21"></a>        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="err">$</span><span class="n">user_id</span><span class="p">,</span>
</span><span id="__codeline__-72-22"><a id="__codelineno-72-22" name="__codelineno-72-22" href="#__codelineno-72-22"></a>        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Test User&quot;</span><span class="p">,</span>
</span><span id="__codeline__-72-23"><a id="__codelineno-72-23" name="__codelineno-72-23" href="#__codelineno-72-23"></a>        <span class="s2">&quot;preferences&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;theme&quot;</span><span class="p">:</span> <span class="s2">&quot;dark&quot;</span><span class="p">}</span>
</span><span id="__codeline__-72-24"><a id="__codelineno-72-24" name="__codelineno-72-24" href="#__codelineno-72-24"></a>    <span class="p">}</span>
</span><span id="__codeline__-72-25"><a id="__codelineno-72-25" name="__codelineno-72-25" href="#__codelineno-72-25"></a><span class="sb">```</span>
</span><span id="__codeline__-72-26"><a id="__codelineno-72-26" name="__codelineno-72-26" href="#__codelineno-72-26"></a>
</span><span id="__codeline__-72-27"><a id="__codelineno-72-27" name="__codelineno-72-27" href="#__codelineno-72-27"></a><span class="gu">## Main</span>
</span><span id="__codeline__-72-28"><a id="__codelineno-72-28" name="__codelineno-72-28" href="#__codelineno-72-28"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-72-29"><a id="__codelineno-72-29" name="__codelineno-72-29" href="#__codelineno-72-29"></a><span class="k">-</span><span class="w"> </span>Ask user for $email and $pin, engage in a conversation till user provides valid values or gives up
</span><span id="__codeline__-72-30"><a id="__codelineno-72-30" name="__codelineno-72-30" href="#__codelineno-72-30"></a><span class="k">-</span><span class="w"> </span>Authenticate user
</span><span id="__codeline__-72-31"><a id="__codelineno-72-31" name="__codelineno-72-31" href="#__codelineno-72-31"></a><span class="k">-</span><span class="w"> </span>If user is authenticated
</span><span id="__codeline__-72-32"><a id="__codelineno-72-32" name="__codelineno-72-32" href="#__codelineno-72-32"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Fetch user profile
</span><span id="__codeline__-72-33"><a id="__codelineno-72-33" name="__codelineno-72-33" href="#__codelineno-72-33"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Welcome user by name from profile
</span><span id="__codeline__-72-34"><a id="__codelineno-72-34" name="__codelineno-72-34" href="#__codelineno-72-34"></a><span class="k">-</span><span class="w"> </span>Otherwise
</span><span id="__codeline__-72-35"><a id="__codelineno-72-35" name="__codelineno-72-35" href="#__codelineno-72-35"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Tell user authentication failed
</span></code></pre></div>
<p>This pattern:</p>
<ul>
<li><strong>Separates backend logic</strong> - keeps the workflow clean and focused</li>
<li><strong>Enables rapid prototyping</strong> - test workflows without backend dependencies  </li>
<li><strong>Makes transition to production easier</strong> - just swap mock with real implementation</li>
<li><strong>Documents backend contracts</strong> - clear interface for what backend needs to provide</li>
<li><strong>Testable</strong> - mock data allows thorough testing of workflows</li>
</ul>
<p><strong>When to use Python playbooks for backend</strong>:</p>
<ul>
<li>Database queries or updates</li>
<li>External API calls</li>
<li>Authentication/authorization checks</li>
<li>Complex business logic calculations</li>
<li>File I/O operations</li>
<li>Any stateful operations</li>
</ul>
<h3 id="best-practices-summary">Best Practices Summary<a class="headerlink" href="#best-practices-summary" title="Permanent link">&para;</a></h3>
<p><strong>DO</strong>:</p>
<ul>
<li>✅ Write playbook descriptions for humans - explain what and why</li>
<li>✅ Use natural language unless explicitness helps</li>
<li>✅ Add <code>### Notes</code> for business rules</li>
<li>✅ Prefer Markdown for workflows, Python for logic</li>
<li>✅ Extract 4+ Python playbooks to MCP server</li>
<li>✅ Make cross-agent playbooks <code>public: true</code></li>
<li>✅ Use triggers sparingly - mainly for input validation</li>
<li>✅ Handle edge cases and errors gracefully</li>
<li>✅ Use meaningful variable names</li>
<li>✅ Break complex playbooks into smaller ones</li>
<li>✅ Test with different user inputs mentally</li>
<li>✅ Ask for all required information at once with conversation loops</li>
<li>✅ Use mock Python playbooks for backend processes during development</li>
</ul>
<p><strong>DON'T</strong>:</p>
<ul>
<li>❌ Over-engineer simple flows</li>
<li>❌ Create too many tiny playbooks</li>
<li>❌ Use Raw mode unless truly needed</li>
<li>❌ Ignore error cases</li>
<li>❌ Make circular agent dependencies</li>
<li>❌ Use explicit syntax when natural language is clear</li>
<li>❌ Forget to document cross-agent contracts</li>
<li>❌ Overuse triggers - prefer explicit calls when flow is clearer</li>
<li>❌ Use triggers for sequential logic</li>
<li>❌ Ask for inputs one at a time when you need multiple pieces of information</li>
<li>❌ Mix backend API calls directly into workflow steps</li>
</ul>
<hr />
<h2 id="editing-existing-programs">Editing Existing Programs<a class="headerlink" href="#editing-existing-programs" title="Permanent link">&para;</a></h2>
<h3 id="surgical-editing-principles">Surgical Editing Principles<a class="headerlink" href="#surgical-editing-principles" title="Permanent link">&para;</a></h3>
<p>When modifying existing Playbooks programs:</p>
<ol>
<li><strong>Read and understand</strong>: Review the file, understand its structure and intent</li>
<li><strong>Minimal changes</strong>: Change only what's needed to achieve the goal</li>
<li><strong>Preserve style</strong>: Match existing natural language vs explicit style</li>
<li><strong>Maintain consistency</strong>: Keep variable naming and structure patterns</li>
<li><strong>Test mentally</strong>: Think through execution flow after changes</li>
</ol>
<h3 id="common-edit-patterns">Common Edit Patterns<a class="headerlink" href="#common-edit-patterns" title="Permanent link">&para;</a></h3>
<p><strong>Adding a new playbook</strong>:
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-73-1"><a id="__codelineno-73-1" name="__codelineno-73-1" href="#__codelineno-73-1"></a><span class="gh"># Existing Agent</span>
</span><span id="__codeline__-73-2"><a id="__codelineno-73-2" name="__codelineno-73-2" href="#__codelineno-73-2"></a>
</span><span id="__codeline__-73-3"><a id="__codelineno-73-3" name="__codelineno-73-3" href="#__codelineno-73-3"></a><span class="gu">## Existing Playbook</span>
</span><span id="__codeline__-73-4"><a id="__codelineno-73-4" name="__codelineno-73-4" href="#__codelineno-73-4"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-73-5"><a id="__codelineno-73-5" name="__codelineno-73-5" href="#__codelineno-73-5"></a><span class="k">-</span><span class="w"> </span>Existing logic
</span><span id="__codeline__-73-6"><a id="__codelineno-73-6" name="__codelineno-73-6" href="#__codelineno-73-6"></a>
</span><span id="__codeline__-73-7"><a id="__codelineno-73-7" name="__codelineno-73-7" href="#__codelineno-73-7"></a>&lt;!-- ADD NEW PLAYBOOK HERE --&gt;
</span><span id="__codeline__-73-8"><a id="__codelineno-73-8" name="__codelineno-73-8" href="#__codelineno-73-8"></a><span class="gu">## NewPlaybook($param)</span>
</span><span id="__codeline__-73-9"><a id="__codelineno-73-9" name="__codelineno-73-9" href="#__codelineno-73-9"></a>Description
</span><span id="__codeline__-73-10"><a id="__codelineno-73-10" name="__codelineno-73-10" href="#__codelineno-73-10"></a>
</span><span id="__codeline__-73-11"><a id="__codelineno-73-11" name="__codelineno-73-11" href="#__codelineno-73-11"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-73-12"><a id="__codelineno-73-12" name="__codelineno-73-12" href="#__codelineno-73-12"></a><span class="k">-</span><span class="w"> </span>New logic
</span></code></pre></div></p>
<p><strong>Modifying steps</strong>:</p>
<ul>
<li>Find the playbook to modify</li>
<li>Locate specific step</li>
<li>Update just that step</li>
<li>Ensure variable references still work</li>
</ul>
<p><strong>Adding a trigger</strong>:
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-74-1"><a id="__codelineno-74-1" name="__codelineno-74-1" href="#__codelineno-74-1"></a><span class="gu">## ExistingPlaybook</span>
</span><span id="__codeline__-74-2"><a id="__codelineno-74-2" name="__codelineno-74-2" href="#__codelineno-74-2"></a>&lt;!-- ADD THIS SECTION IF MISSING --&gt;
</span><span id="__codeline__-74-3"><a id="__codelineno-74-3" name="__codelineno-74-3" href="#__codelineno-74-3"></a><span class="gu">### Triggers</span>
</span><span id="__codeline__-74-4"><a id="__codelineno-74-4" name="__codelineno-74-4" href="#__codelineno-74-4"></a><span class="k">-</span><span class="w"> </span>When condition is met
</span><span id="__codeline__-74-5"><a id="__codelineno-74-5" name="__codelineno-74-5" href="#__codelineno-74-5"></a>
</span><span id="__codeline__-74-6"><a id="__codelineno-74-6" name="__codelineno-74-6" href="#__codelineno-74-6"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-74-7"><a id="__codelineno-74-7" name="__codelineno-74-7" href="#__codelineno-74-7"></a><span class="k">-</span><span class="w"> </span>Existing steps
</span></code></pre></div></p>
<p><strong>Adding agent behavior</strong>:</p>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-75-1"><a id="__codelineno-75-1" name="__codelineno-75-1" href="#__codelineno-75-1"></a><span class="gh"># ExistingAgent</span>
</span><span id="__codeline__-75-2"><a id="__codelineno-75-2" name="__codelineno-75-2" href="#__codelineno-75-2"></a>&lt;!-- MODIFY THIS DESCRIPTION --&gt;
</span><span id="__codeline__-75-3"><a id="__codelineno-75-3" name="__codelineno-75-3" href="#__codelineno-75-3"></a>Existing description. NEW BEHAVIOR: Additional personality trait or capability.
</span></code></pre></div>
<p><strong>Converting natural to explicit</strong>:</p>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-76-1"><a id="__codelineno-76-1" name="__codelineno-76-1" href="#__codelineno-76-1"></a>&lt;!-- BEFORE --&gt;
</span><span id="__codeline__-76-2"><a id="__codelineno-76-2" name="__codelineno-76-2" href="#__codelineno-76-2"></a><span class="k">-</span><span class="w"> </span>Get order details and tell user
</span><span id="__codeline__-76-3"><a id="__codelineno-76-3" name="__codelineno-76-3" href="#__codelineno-76-3"></a>
</span><span id="__codeline__-76-4"><a id="__codelineno-76-4" name="__codelineno-76-4" href="#__codelineno-76-4"></a>&lt;!-- AFTER (if user requests more structure) --&gt;
</span><span id="__codeline__-76-5"><a id="__codelineno-76-5" name="__codelineno-76-5" href="#__codelineno-76-5"></a><span class="k">-</span><span class="w"> </span>$order = GetOrderDetails($order_id)
</span><span id="__codeline__-76-6"><a id="__codelineno-76-6" name="__codelineno-76-6" href="#__codelineno-76-6"></a><span class="k">-</span><span class="w"> </span>Tell user about $order
</span></code></pre></div>
<h3 id="example-edit-request">Example Edit Request<a class="headerlink" href="#example-edit-request" title="Permanent link">&para;</a></h3>
<p><strong>Request</strong>: "Add validation to ensure order ID is 8 digits"</p>
<p><strong>Process</strong>:</p>
<ol>
<li>Locate where order ID is collected</li>
<li>Add validation playbook</li>
<li>Add trigger to invoke validation</li>
<li>Update main flow to handle invalid input</li>
</ol>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-77-1"><a id="__codelineno-77-1" name="__codelineno-77-1" href="#__codelineno-77-1"></a><span class="gu">## Main</span>
</span><span id="__codeline__-77-2"><a id="__codelineno-77-2" name="__codelineno-77-2" href="#__codelineno-77-2"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-77-3"><a id="__codelineno-77-3" name="__codelineno-77-3" href="#__codelineno-77-3"></a><span class="k">-</span><span class="w"> </span>Ask user for their $order_id till valid  &lt;!-- MODIFIED --&gt;
</span><span id="__codeline__-77-4"><a id="__codelineno-77-4" name="__codelineno-77-4" href="#__codelineno-77-4"></a><span class="k">-</span><span class="w"> </span>Process order
</span><span id="__codeline__-77-5"><a id="__codelineno-77-5" name="__codelineno-77-5" href="#__codelineno-77-5"></a>
</span><span id="__codeline__-77-6"><a id="__codelineno-77-6" name="__codelineno-77-6" href="#__codelineno-77-6"></a><span class="gu">## ValidateOrderId  &lt;!-- NEW PLAYBOOK --&gt;</span>
</span><span id="__codeline__-77-7"><a id="__codelineno-77-7" name="__codelineno-77-7" href="#__codelineno-77-7"></a><span class="gu">### Triggers</span>
</span><span id="__codeline__-77-8"><a id="__codelineno-77-8" name="__codelineno-77-8" href="#__codelineno-77-8"></a><span class="k">-</span><span class="w"> </span>When user provides order id
</span><span id="__codeline__-77-9"><a id="__codelineno-77-9" name="__codelineno-77-9" href="#__codelineno-77-9"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-77-10"><a id="__codelineno-77-10" name="__codelineno-77-10" href="#__codelineno-77-10"></a><span class="k">-</span><span class="w"> </span>If $order_id is not 8 digits
</span><span id="__codeline__-77-11"><a id="__codelineno-77-11" name="__codelineno-77-11" href="#__codelineno-77-11"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Tell user order ID must be 8 digits
</span><span id="__codeline__-77-12"><a id="__codelineno-77-12" name="__codelineno-77-12" href="#__codelineno-77-12"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Ask for order ID again
</span></code></pre></div>
<hr />
<h2 id="understanding-pbasm-compilation">Understanding PBAsm Compilation<a class="headerlink" href="#understanding-pbasm-compilation" title="Permanent link">&para;</a></h2>
<h3 id="why-pbasm-matters">Why PBAsm Matters<a class="headerlink" href="#why-pbasm-matters" title="Permanent link">&para;</a></h3>
<p>When you write Playbooks, the compiler transforms it to Playbooks Assembly Language (PBAsm):</p>
<ul>
<li><strong>Adds explicit types</strong>: <code>$name</code> → <code>$name:str</code></li>
<li><strong>Adds line numbers</strong>: Hierarchical (01, 01.01, 01.01.01)</li>
<li><strong>Adds opcodes</strong>: QUE (queue), CND (conditional), RET (return), YLD (yield)</li>
<li><strong>Explicit yields</strong>: Shows when LLM yields control</li>
<li><strong>Trigger labels</strong>: T1:BGN, T2:CND, etc.</li>
</ul>
<h3 id="compilation-example">Compilation Example<a class="headerlink" href="#compilation-example" title="Permanent link">&para;</a></h3>
<p><strong>Source (Playbooks)</strong>:</p>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-78-1"><a id="__codelineno-78-1" name="__codelineno-78-1" href="#__codelineno-78-1"></a><span class="gu">## GreetUser</span>
</span><span id="__codeline__-78-2"><a id="__codelineno-78-2" name="__codelineno-78-2" href="#__codelineno-78-2"></a><span class="gu">### Triggers</span>
</span><span id="__codeline__-78-3"><a id="__codelineno-78-3" name="__codelineno-78-3" href="#__codelineno-78-3"></a><span class="k">-</span><span class="w"> </span>At the beginning
</span><span id="__codeline__-78-4"><a id="__codelineno-78-4" name="__codelineno-78-4" href="#__codelineno-78-4"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-78-5"><a id="__codelineno-78-5" name="__codelineno-78-5" href="#__codelineno-78-5"></a><span class="k">-</span><span class="w"> </span>Ask user for their name
</span><span id="__codeline__-78-6"><a id="__codelineno-78-6" name="__codelineno-78-6" href="#__codelineno-78-6"></a><span class="k">-</span><span class="w"> </span>If name provided
</span><span id="__codeline__-78-7"><a id="__codelineno-78-7" name="__codelineno-78-7" href="#__codelineno-78-7"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Thank user by name
</span><span id="__codeline__-78-8"><a id="__codelineno-78-8" name="__codelineno-78-8" href="#__codelineno-78-8"></a><span class="k">-</span><span class="w"> </span>Otherwise
</span><span id="__codeline__-78-9"><a id="__codelineno-78-9" name="__codelineno-78-9" href="#__codelineno-78-9"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Ask again
</span></code></pre></div>
<p><strong>Compiled (PBAsm)</strong>:</p>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-79-1"><a id="__codelineno-79-1" name="__codelineno-79-1" href="#__codelineno-79-1"></a><span class="gu">## GreetUser() -&gt; None</span>
</span><span id="__codeline__-79-2"><a id="__codelineno-79-2" name="__codelineno-79-2" href="#__codelineno-79-2"></a><span class="gu">### Triggers</span>
</span><span id="__codeline__-79-3"><a id="__codelineno-79-3" name="__codelineno-79-3" href="#__codelineno-79-3"></a><span class="k">-</span><span class="w"> </span>T1:BGN At the beginning
</span><span id="__codeline__-79-4"><a id="__codelineno-79-4" name="__codelineno-79-4" href="#__codelineno-79-4"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-79-5"><a id="__codelineno-79-5" name="__codelineno-79-5" href="#__codelineno-79-5"></a><span class="k">-</span><span class="w"> </span>01:QUE Say(user, Ask user for their $name:str); YLD for user
</span><span id="__codeline__-79-6"><a id="__codelineno-79-6" name="__codelineno-79-6" href="#__codelineno-79-6"></a><span class="k">-</span><span class="w"> </span>02:CND If $name is provided
</span><span id="__codeline__-79-7"><a id="__codelineno-79-7" name="__codelineno-79-7" href="#__codelineno-79-7"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>02.01:QUE Say(user, Thank user by $name); YLD for call
</span><span id="__codeline__-79-8"><a id="__codelineno-79-8" name="__codelineno-79-8" href="#__codelineno-79-8"></a><span class="k">-</span><span class="w"> </span>03:CND Otherwise  
</span><span id="__codeline__-79-9"><a id="__codelineno-79-9" name="__codelineno-79-9" href="#__codelineno-79-9"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>03.01:QUE Say(user, Ask for $name again); YLD for user
</span><span id="__codeline__-79-10"><a id="__codelineno-79-10" name="__codelineno-79-10" href="#__codelineno-79-10"></a><span class="k">-</span><span class="w"> </span>04:RET
</span></code></pre></div>
<h3 id="key-pbasm-concepts">Key PBAsm Concepts<a class="headerlink" href="#key-pbasm-concepts" title="Permanent link">&para;</a></h3>
<p><strong>Opcodes</strong> (like CPU instructions):</p>
<ul>
<li><code>QUE</code> - Queue operation (function call, Say)</li>
<li><code>CND</code> - Conditional/loop</li>
<li><code>RET</code> - Return from playbook</li>
<li><code>YLD</code> - Yield control to runtime</li>
<li><code>EXE</code> - Execute assignment/action</li>
<li><code>TNK</code> - Think deeply</li>
<li><code>JMP</code> - Jump to line (loops)</li>
</ul>
<p><strong>Yield Reasons</strong> (why LLM pauses):</p>
<ul>
<li><code>YLD for user</code> - Wait for user input</li>
<li><code>YLD for call</code> - Execute queued calls</li>
<li><code>YLD for agent</code> - Wait for agent message</li>
<li><code>YLD for meeting</code> - Wait for meeting message</li>
<li><code>YLD for exit</code> - End program</li>
</ul>
<p><strong>Line Numbers</strong> (like assembly addresses):</p>
<ul>
<li>Hierarchical: 01, 01.01, 01.02, 01.02.01</li>
<li>Enable jumps for loops</li>
<li>Track execution position</li>
</ul>
<h3 id="why-this-helps-you">Why This Helps You<a class="headerlink" href="#why-this-helps-you" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Debugging</strong>: When user reports issues, think about PBAsm execution</li>
<li><strong>Precision</strong>: Know that fuzzy NL gets converted to structured form</li>
<li><strong>Optimization</strong>: Understand when LLM calls happen (at YLD points)</li>
<li><strong>Reasoning</strong>: Picture how LLM executes line by line</li>
</ol>
<h3 id="you-dont-need-to-write-pbasm">You Don't Need to Write PBAsm<a class="headerlink" href="#you-dont-need-to-write-pbasm" title="Permanent link">&para;</a></h3>
<ul>
<li>❌ Never write PBAsm directly</li>
<li>✅ Write natural Playbooks language</li>
<li>✅ Compiler handles transformation</li>
<li>✅ Understanding PBAsm helps debugging and optimization</li>
</ul>
<hr />
<h2 id="quick-reference">Quick Reference<a class="headerlink" href="#quick-reference" title="Permanent link">&para;</a></h2>
<h3 id="minimal-working-program">Minimal Working Program<a class="headerlink" href="#minimal-working-program" title="Permanent link">&para;</a></h3>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-80-1"><a id="__codelineno-80-1" name="__codelineno-80-1" href="#__codelineno-80-1"></a><span class="gh"># MyAgent</span>
</span><span id="__codeline__-80-2"><a id="__codelineno-80-2" name="__codelineno-80-2" href="#__codelineno-80-2"></a>Description of what this agent does
</span><span id="__codeline__-80-3"><a id="__codelineno-80-3" name="__codelineno-80-3" href="#__codelineno-80-3"></a>
</span><span id="__codeline__-80-4"><a id="__codelineno-80-4" name="__codelineno-80-4" href="#__codelineno-80-4"></a><span class="gu">## Main</span>
</span><span id="__codeline__-80-5"><a id="__codelineno-80-5" name="__codelineno-80-5" href="#__codelineno-80-5"></a><span class="gu">### Triggers</span>
</span><span id="__codeline__-80-6"><a id="__codelineno-80-6" name="__codelineno-80-6" href="#__codelineno-80-6"></a><span class="k">-</span><span class="w"> </span>At the beginning
</span><span id="__codeline__-80-7"><a id="__codelineno-80-7" name="__codelineno-80-7" href="#__codelineno-80-7"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-80-8"><a id="__codelineno-80-8" name="__codelineno-80-8" href="#__codelineno-80-8"></a><span class="k">-</span><span class="w"> </span>Greet user
</span><span id="__codeline__-80-9"><a id="__codelineno-80-9" name="__codelineno-80-9" href="#__codelineno-80-9"></a><span class="k">-</span><span class="w"> </span>Ask user what they need help with
</span><span id="__codeline__-80-10"><a id="__codelineno-80-10" name="__codelineno-80-10" href="#__codelineno-80-10"></a><span class="k">-</span><span class="w"> </span>Help them
</span><span id="__codeline__-80-11"><a id="__codelineno-80-11" name="__codelineno-80-11" href="#__codelineno-80-11"></a><span class="k">-</span><span class="w"> </span>End program
</span></code></pre></div>
<h3 id="more-complex-example">More complex example<a class="headerlink" href="#more-complex-example" title="Permanent link">&para;</a></h3>
<div class="language-markdown highlight"><pre><span></span><code><span id="__codeline__-81-1"><a id="__codelineno-81-1" name="__codelineno-81-1" href="#__codelineno-81-1"></a><span class="gh"># Hello world agent</span>
</span><span id="__codeline__-81-2"><a id="__codelineno-81-2" name="__codelineno-81-2" href="#__codelineno-81-2"></a>A demo customer support agent for Playbooks AI
</span><span id="__codeline__-81-3"><a id="__codelineno-81-3" name="__codelineno-81-3" href="#__codelineno-81-3"></a>
</span><span id="__codeline__-81-4"><a id="__codelineno-81-4" name="__codelineno-81-4" href="#__codelineno-81-4"></a><span class="sb">```python</span>
</span><span id="__codeline__-81-5"><a id="__codelineno-81-5" name="__codelineno-81-5" href="#__codelineno-81-5"></a><span class="nd">@playbook</span>
</span><span id="__codeline__-81-6"><a id="__codelineno-81-6" name="__codelineno-81-6" href="#__codelineno-81-6"></a><span class="k">async</span> <span class="k">def</span> <span class="nf">SendOTP</span><span class="p">(</span><span class="n">phone_number</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="__codeline__-81-7"><a id="__codelineno-81-7" name="__codelineno-81-7" href="#__codelineno-81-7"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__codeline__-81-8"><a id="__codelineno-81-8" name="__codelineno-81-8" href="#__codelineno-81-8"></a><span class="sd">    Send OTP to user&#39;s phone number via backend service.</span>
</span><span id="__codeline__-81-9"><a id="__codelineno-81-9" name="__codelineno-81-9" href="#__codelineno-81-9"></a>
</span><span id="__codeline__-81-10"><a id="__codelineno-81-10" name="__codelineno-81-10" href="#__codelineno-81-10"></a><span class="sd">    In production, this would call the actual SMS/OTP service.</span>
</span><span id="__codeline__-81-11"><a id="__codelineno-81-11" name="__codelineno-81-11" href="#__codelineno-81-11"></a><span class="sd">    For development, using mock implementation.</span>
</span><span id="__codeline__-81-12"><a id="__codelineno-81-12" name="__codelineno-81-12" href="#__codelineno-81-12"></a>
</span><span id="__codeline__-81-13"><a id="__codelineno-81-13" name="__codelineno-81-13" href="#__codelineno-81-13"></a><span class="sd">    Args:</span>
</span><span id="__codeline__-81-14"><a id="__codelineno-81-14" name="__codelineno-81-14" href="#__codelineno-81-14"></a><span class="sd">        phone_number: User&#39;s phone number</span>
</span><span id="__codeline__-81-15"><a id="__codelineno-81-15" name="__codelineno-81-15" href="#__codelineno-81-15"></a>
</span><span id="__codeline__-81-16"><a id="__codelineno-81-16" name="__codelineno-81-16" href="#__codelineno-81-16"></a><span class="sd">    Returns:</span>
</span><span id="__codeline__-81-17"><a id="__codelineno-81-17" name="__codelineno-81-17" href="#__codelineno-81-17"></a><span class="sd">        Dictionary with status and OTP (in dev mode only)</span>
</span><span id="__codeline__-81-18"><a id="__codelineno-81-18" name="__codelineno-81-18" href="#__codelineno-81-18"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__codeline__-81-19"><a id="__codelineno-81-19" name="__codelineno-81-19" href="#__codelineno-81-19"></a>    <span class="c1"># Mock implementation for development</span>
</span><span id="__codeline__-81-20"><a id="__codelineno-81-20" name="__codelineno-81-20" href="#__codelineno-81-20"></a>    <span class="c1"># In production, this would call your SMS service</span>
</span><span id="__codeline__-81-21"><a id="__codelineno-81-21" name="__codelineno-81-21" href="#__codelineno-81-21"></a>    <span class="kn">import</span> <span class="nn">random</span>
</span><span id="__codeline__-81-22"><a id="__codelineno-81-22" name="__codelineno-81-22" href="#__codelineno-81-22"></a>    <span class="n">otp</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">9999</span><span class="p">))</span>
</span><span id="__codeline__-81-23"><a id="__codelineno-81-23" name="__codelineno-81-23" href="#__codelineno-81-23"></a>
</span><span id="__codeline__-81-24"><a id="__codelineno-81-24" name="__codelineno-81-24" href="#__codelineno-81-24"></a>    <span class="c1"># Simulate successful send</span>
</span><span id="__codeline__-81-25"><a id="__codelineno-81-25" name="__codelineno-81-25" href="#__codelineno-81-25"></a>    <span class="k">return</span> <span class="p">{</span>
</span><span id="__codeline__-81-26"><a id="__codelineno-81-26" name="__codelineno-81-26" href="#__codelineno-81-26"></a>        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span><span class="p">,</span>
</span><span id="__codeline__-81-27"><a id="__codelineno-81-27" name="__codelineno-81-27" href="#__codelineno-81-27"></a>        <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;OTP sent to </span><span class="si">{</span><span class="n">phone_number</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__codeline__-81-28"><a id="__codelineno-81-28" name="__codelineno-81-28" href="#__codelineno-81-28"></a>        <span class="s2">&quot;otp&quot;</span><span class="p">:</span> <span class="n">otp</span>  <span class="c1"># Only for development - remove in production</span>
</span><span id="__codeline__-81-29"><a id="__codelineno-81-29" name="__codelineno-81-29" href="#__codelineno-81-29"></a>    <span class="p">}</span>
</span><span id="__codeline__-81-30"><a id="__codelineno-81-30" name="__codelineno-81-30" href="#__codelineno-81-30"></a>
</span><span id="__codeline__-81-31"><a id="__codelineno-81-31" name="__codelineno-81-31" href="#__codelineno-81-31"></a><span class="nd">@playbook</span>
</span><span id="__codeline__-81-32"><a id="__codelineno-81-32" name="__codelineno-81-32" href="#__codelineno-81-32"></a><span class="k">async</span> <span class="k">def</span> <span class="nf">ValidateOTP</span><span class="p">(</span><span class="n">phone_number</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">otp</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__codeline__-81-33"><a id="__codelineno-81-33" name="__codelineno-81-33" href="#__codelineno-81-33"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__codeline__-81-34"><a id="__codelineno-81-34" name="__codelineno-81-34" href="#__codelineno-81-34"></a><span class="sd">    Validate OTP against backend service.</span>
</span><span id="__codeline__-81-35"><a id="__codelineno-81-35" name="__codelineno-81-35" href="#__codelineno-81-35"></a>
</span><span id="__codeline__-81-36"><a id="__codelineno-81-36" name="__codelineno-81-36" href="#__codelineno-81-36"></a><span class="sd">    In production, this would verify OTP with your authentication service.</span>
</span><span id="__codeline__-81-37"><a id="__codelineno-81-37" name="__codelineno-81-37" href="#__codelineno-81-37"></a><span class="sd">    For development, using mock validation.</span>
</span><span id="__codeline__-81-38"><a id="__codelineno-81-38" name="__codelineno-81-38" href="#__codelineno-81-38"></a>
</span><span id="__codeline__-81-39"><a id="__codelineno-81-39" name="__codelineno-81-39" href="#__codelineno-81-39"></a><span class="sd">    Args:</span>
</span><span id="__codeline__-81-40"><a id="__codelineno-81-40" name="__codelineno-81-40" href="#__codelineno-81-40"></a><span class="sd">        phone_number: User&#39;s phone number</span>
</span><span id="__codeline__-81-41"><a id="__codelineno-81-41" name="__codelineno-81-41" href="#__codelineno-81-41"></a><span class="sd">        otp: OTP code provided by user</span>
</span><span id="__codeline__-81-42"><a id="__codelineno-81-42" name="__codelineno-81-42" href="#__codelineno-81-42"></a>
</span><span id="__codeline__-81-43"><a id="__codelineno-81-43" name="__codelineno-81-43" href="#__codelineno-81-43"></a><span class="sd">    Returns:</span>
</span><span id="__codeline__-81-44"><a id="__codelineno-81-44" name="__codelineno-81-44" href="#__codelineno-81-44"></a><span class="sd">        True if OTP is valid, False otherwise</span>
</span><span id="__codeline__-81-45"><a id="__codelineno-81-45" name="__codelineno-81-45" href="#__codelineno-81-45"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__codeline__-81-46"><a id="__codelineno-81-46" name="__codelineno-81-46" href="#__codelineno-81-46"></a>    <span class="c1"># Mock implementation for development</span>
</span><span id="__codeline__-81-47"><a id="__codelineno-81-47" name="__codelineno-81-47" href="#__codelineno-81-47"></a>    <span class="c1"># In production, this would validate against your backend</span>
</span><span id="__codeline__-81-48"><a id="__codelineno-81-48" name="__codelineno-81-48" href="#__codelineno-81-48"></a>
</span><span id="__codeline__-81-49"><a id="__codelineno-81-49" name="__codelineno-81-49" href="#__codelineno-81-49"></a>    <span class="c1"># For demo: accept any 4-digit OTP</span>
</span><span id="__codeline__-81-50"><a id="__codelineno-81-50" name="__codelineno-81-50" href="#__codelineno-81-50"></a>    <span class="c1"># In real system, verify against stored OTP with expiration</span>
</span><span id="__codeline__-81-51"><a id="__codelineno-81-51" name="__codelineno-81-51" href="#__codelineno-81-51"></a>    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">otp</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span> <span class="ow">and</span> <span class="n">otp</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span>
</span><span id="__codeline__-81-52"><a id="__codelineno-81-52" name="__codelineno-81-52" href="#__codelineno-81-52"></a><span class="sb">```</span>
</span><span id="__codeline__-81-53"><a id="__codelineno-81-53" name="__codelineno-81-53" href="#__codelineno-81-53"></a>
</span><span id="__codeline__-81-54"><a id="__codelineno-81-54" name="__codelineno-81-54" href="#__codelineno-81-54"></a><span class="gu">## Main</span>
</span><span id="__codeline__-81-55"><a id="__codelineno-81-55" name="__codelineno-81-55" href="#__codelineno-81-55"></a>
</span><span id="__codeline__-81-56"><a id="__codelineno-81-56" name="__codelineno-81-56" href="#__codelineno-81-56"></a><span class="gu">### Triggers</span>
</span><span id="__codeline__-81-57"><a id="__codelineno-81-57" name="__codelineno-81-57" href="#__codelineno-81-57"></a><span class="k">-</span><span class="w"> </span>At the beginning
</span><span id="__codeline__-81-58"><a id="__codelineno-81-58" name="__codelineno-81-58" href="#__codelineno-81-58"></a>
</span><span id="__codeline__-81-59"><a id="__codelineno-81-59" name="__codelineno-81-59" href="#__codelineno-81-59"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-81-60"><a id="__codelineno-81-60" name="__codelineno-81-60" href="#__codelineno-81-60"></a><span class="k">-</span><span class="w"> </span>Welcome user
</span><span id="__codeline__-81-61"><a id="__codelineno-81-61" name="__codelineno-81-61" href="#__codelineno-81-61"></a><span class="k">-</span><span class="w"> </span>Authenticate user
</span><span id="__codeline__-81-62"><a id="__codelineno-81-62" name="__codelineno-81-62" href="#__codelineno-81-62"></a><span class="k">-</span><span class="w"> </span>If authentication successful
</span><span id="__codeline__-81-63"><a id="__codelineno-81-63" name="__codelineno-81-63" href="#__codelineno-81-63"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Tell user about Playbooks AI
</span><span id="__codeline__-81-64"><a id="__codelineno-81-64" name="__codelineno-81-64" href="#__codelineno-81-64"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Ask the user for their $name
</span><span id="__codeline__-81-65"><a id="__codelineno-81-65" name="__codelineno-81-65" href="#__codelineno-81-65"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Say hello to the user by $name
</span><span id="__codeline__-81-66"><a id="__codelineno-81-66" name="__codelineno-81-66" href="#__codelineno-81-66"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Welcome user to Playbooks AI
</span><span id="__codeline__-81-67"><a id="__codelineno-81-67" name="__codelineno-81-67" href="#__codelineno-81-67"></a><span class="k">-</span><span class="w"> </span>Otherwise
</span><span id="__codeline__-81-68"><a id="__codelineno-81-68" name="__codelineno-81-68" href="#__codelineno-81-68"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Tell user authentication failed
</span><span id="__codeline__-81-69"><a id="__codelineno-81-69" name="__codelineno-81-69" href="#__codelineno-81-69"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Apologize and end program
</span><span id="__codeline__-81-70"><a id="__codelineno-81-70" name="__codelineno-81-70" href="#__codelineno-81-70"></a><span class="k">-</span><span class="w"> </span>End program
</span><span id="__codeline__-81-71"><a id="__codelineno-81-71" name="__codelineno-81-71" href="#__codelineno-81-71"></a>
</span><span id="__codeline__-81-72"><a id="__codelineno-81-72" name="__codelineno-81-72" href="#__codelineno-81-72"></a><span class="gu">## AuthenticateUser</span>
</span><span id="__codeline__-81-73"><a id="__codelineno-81-73" name="__codelineno-81-73" href="#__codelineno-81-73"></a>Authenticate user by collecting phone number, sending OTP, and validating the code.
</span><span id="__codeline__-81-74"><a id="__codelineno-81-74" name="__codelineno-81-74" href="#__codelineno-81-74"></a>
</span><span id="__codeline__-81-75"><a id="__codelineno-81-75" name="__codelineno-81-75" href="#__codelineno-81-75"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-81-76"><a id="__codelineno-81-76" name="__codelineno-81-76" href="#__codelineno-81-76"></a><span class="k">-</span><span class="w"> </span>Ask user for their $phone_number, engage in conversation till user provides a valid phone number or gives up
</span><span id="__codeline__-81-77"><a id="__codelineno-81-77" name="__codelineno-81-77" href="#__codelineno-81-77"></a><span class="k">-</span><span class="w"> </span>If user gives up
</span><span id="__codeline__-81-78"><a id="__codelineno-81-78" name="__codelineno-81-78" href="#__codelineno-81-78"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Return authentication failure
</span><span id="__codeline__-81-79"><a id="__codelineno-81-79" name="__codelineno-81-79" href="#__codelineno-81-79"></a><span class="k">-</span><span class="w"> </span>Send OTP to $phone_number
</span><span id="__codeline__-81-80"><a id="__codelineno-81-80" name="__codelineno-81-80" href="#__codelineno-81-80"></a><span class="k">-</span><span class="w"> </span>Tell user that OTP has been sent to their phone number
</span><span id="__codeline__-81-81"><a id="__codelineno-81-81" name="__codelineno-81-81" href="#__codelineno-81-81"></a><span class="k">-</span><span class="w"> </span>Ask user for the $otp they received, engage in conversation till user provides it or gives up
</span><span id="__codeline__-81-82"><a id="__codelineno-81-82" name="__codelineno-81-82" href="#__codelineno-81-82"></a><span class="k">-</span><span class="w"> </span>If user gives up
</span><span id="__codeline__-81-83"><a id="__codelineno-81-83" name="__codelineno-81-83" href="#__codelineno-81-83"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Return authentication failure
</span><span id="__codeline__-81-84"><a id="__codelineno-81-84" name="__codelineno-81-84" href="#__codelineno-81-84"></a><span class="k">-</span><span class="w"> </span>Validate the OTP
</span><span id="__codeline__-81-85"><a id="__codelineno-81-85" name="__codelineno-81-85" href="#__codelineno-81-85"></a><span class="k">-</span><span class="w"> </span>If OTP is valid
</span><span id="__codeline__-81-86"><a id="__codelineno-81-86" name="__codelineno-81-86" href="#__codelineno-81-86"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Return authentication success
</span><span id="__codeline__-81-87"><a id="__codelineno-81-87" name="__codelineno-81-87" href="#__codelineno-81-87"></a><span class="k">-</span><span class="w"> </span>Otherwise
</span><span id="__codeline__-81-88"><a id="__codelineno-81-88" name="__codelineno-81-88" href="#__codelineno-81-88"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Tell user that the OTP didn&#39;t work
</span><span id="__codeline__-81-89"><a id="__codelineno-81-89" name="__codelineno-81-89" href="#__codelineno-81-89"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>Ask if user want to enter a different one or would like another OTP
</span><span id="__codeline__-81-90"><a id="__codelineno-81-90" name="__codelineno-81-90" href="#__codelineno-81-90"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>If usre provided a new OTP
</span><span id="__codeline__-81-91"><a id="__codelineno-81-91" name="__codelineno-81-91" href="#__codelineno-81-91"></a><span class="w">    </span><span class="k">-</span><span class="w"> </span>jump back to validating it
</span><span id="__codeline__-81-92"><a id="__codelineno-81-92" name="__codelineno-81-92" href="#__codelineno-81-92"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>If user wants to try again
</span><span id="__codeline__-81-93"><a id="__codelineno-81-93" name="__codelineno-81-93" href="#__codelineno-81-93"></a><span class="w">    </span><span class="k">-</span><span class="w"> </span>jump back to asking/validating OTP or sending a new one as appropriate
</span><span id="__codeline__-81-94"><a id="__codelineno-81-94" name="__codelineno-81-94" href="#__codelineno-81-94"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>If user want to give up
</span><span id="__codeline__-81-95"><a id="__codelineno-81-95" name="__codelineno-81-95" href="#__codelineno-81-95"></a><span class="w">    </span><span class="k">-</span><span class="w"> </span>Return authentication failure
</span><span id="__codeline__-81-96"><a id="__codelineno-81-96" name="__codelineno-81-96" href="#__codelineno-81-96"></a>
</span><span id="__codeline__-81-97"><a id="__codelineno-81-97" name="__codelineno-81-97" href="#__codelineno-81-97"></a><span class="gu">## ValidatePhoneNumber</span>
</span><span id="__codeline__-81-98"><a id="__codelineno-81-98" name="__codelineno-81-98" href="#__codelineno-81-98"></a><span class="gu">### Triggers</span>
</span><span id="__codeline__-81-99"><a id="__codelineno-81-99" name="__codelineno-81-99" href="#__codelineno-81-99"></a><span class="k">-</span><span class="w"> </span>When user provides phone number
</span><span id="__codeline__-81-100"><a id="__codelineno-81-100" name="__codelineno-81-100" href="#__codelineno-81-100"></a>
</span><span id="__codeline__-81-101"><a id="__codelineno-81-101" name="__codelineno-81-101" href="#__codelineno-81-101"></a><span class="gu">### Steps</span>
</span><span id="__codeline__-81-102"><a id="__codelineno-81-102" name="__codelineno-81-102" href="#__codelineno-81-102"></a><span class="k">-</span><span class="w"> </span>Check if $phone_number is a valid US phone number or not
</span></code></pre></div>
<h3 id="cheat-sheet">Cheat Sheet<a class="headerlink" href="#cheat-sheet" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Task</th>
<th>Code</th>
</tr>
</thead>
<tbody>
<tr>
<td>Define agent</td>
<td><code># AgentName</code></td>
</tr>
<tr>
<td>Define playbook</td>
<td><code>## PlaybookName($param)</code></td>
</tr>
<tr>
<td>Add trigger</td>
<td><code>### Triggers</code><br><code>- When condition</code></td>
</tr>
<tr>
<td>Add steps</td>
<td><code>### Steps</code><br><code>- Step 1</code></td>
</tr>
<tr>
<td>Variable</td>
<td><code>$variable_name</code></td>
</tr>
<tr>
<td>Typed variable</td>
<td><code>$count:int</code></td>
</tr>
<tr>
<td>Assignment</td>
<td><code>$var = value</code></td>
</tr>
<tr>
<td>Condition</td>
<td><code>If condition</code><br><code>- Then step</code></td>
</tr>
<tr>
<td>Loop</td>
<td><code>While condition</code><br><code>- Loop step</code></td>
</tr>
<tr>
<td>Return</td>
<td><code>Return value</code></td>
</tr>
<tr>
<td>End program</td>
<td><code>End program</code></td>
</tr>
<tr>
<td>Call playbook</td>
<td><code>PlaybookName($arg)</code></td>
</tr>
<tr>
<td>Cross-agent call</td>
<td><code>OtherAgent.PlaybookName($arg)</code></td>
</tr>
<tr>
<td>Python playbook</td>
<td><code>@playbook</code><br><code>async def Name(): ...</code></td>
</tr>
<tr>
<td>Public playbook</td>
<td><code>public: true</code></td>
</tr>
<tr>
<td>ReAct playbook</td>
<td>No <code>### Steps</code> section</td>
</tr>
<tr>
<td>Raw playbook</td>
<td><code>execution_mode: raw</code></td>
</tr>
<tr>
<td>Meeting playbook</td>
<td><code>meeting: true</code></td>
</tr>
<tr>
<td>Save artifact</td>
<td><code>SaveArtifact("name", "desc", $content)</code></td>
</tr>
<tr>
<td>Load artifact</td>
<td><code>LoadArtifact("name")</code></td>
</tr>
<tr>
<td>Placeholder</td>
<td><code>{$variable}</code> or <code>{expression}</code></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="programming-principles">Programming Principles<a class="headerlink" href="#programming-principles" title="Permanent link">&para;</a></h2>
<p>When writing Playbooks programs:</p>
<ol>
<li><strong>Understand intent</strong>: What problem are you solving? What is the goal?</li>
<li><strong>Choose right types</strong>: Markdown for workflows, Python for logic, ReAct for research</li>
<li><strong>Natural first</strong>: Start with natural language, add explicitness if needed</li>
<li><strong>Think decomposition</strong>: Break into logical playbooks with clear responsibilities</li>
<li><strong>Extract to MCP</strong>: If you have 4+ Python playbooks, extract them to an MCP server</li>
<li><strong>Handle errors</strong>: Consider edge cases and failure modes</li>
<li><strong>Write idiomatically</strong>: Follow patterns and conventions from examples</li>
<li><strong>Document choices</strong>: Explain intent in descriptions and comments</li>
<li><strong>Iterate</strong>: Start simple, add complexity as needed</li>
</ol>
<p><strong>Remember</strong>: You're writing Software 3.0 - programs that execute on LLMs. Embrace natural language while maintaining precision. The compiler and runtime handle the complexity.</p>
<hr />
<h2 id="for-ai-coding-assistants">For AI Coding Assistants<a class="headerlink" href="#for-ai-coding-assistants" title="Permanent link">&para;</a></h2>
<p>When helping users write Playbooks programs:</p>
<ul>
<li>Think deeply, plan in detail and review the plan before writing any code</li>
<li>Follow all the principles and patterns in this guide</li>
<li>Prefer natural language over explicit syntax unless clarity demands it</li>
<li>Always consider if 4+ Python playbooks should be extracted to an MCP server</li>
<li>Use triggers sparingly - mainly for input validation</li>
<li>Explain your architectural choices to help users learn</li>
<li>Iterate based on user feedback and requirements</li>
<li>Make sure that the program reads like a human wrote it and something that an AI model would be able to understand and execute</li>
<li>If you need to write many python functions, put them into an MCP server with mock or real implementations as appropriate.</li>
<li>Make sure to write ideomatic Playbooks code that uses Playbooks capabilities optimally to produce minimal, clean, readable, well organized Playbooks programs.</li>
<li>When converting/importing/migrating from LangGraph, CrewAI, etc. agent frameworks, make sure to produce the same behavior, but also represented using all of Playbooks capabilities which may produce significantly concise implementation compared to LangGraph.</li>
</ul>
<p>Happy building! 🚀</p>









  




                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../getting-started/migrating/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Migrating from Other Agent Frameworks">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Migrating from Other Agent Frameworks
              </div>
            </div>
          </a>
        
        
          
          <a href="../tutorials/" class="md-footer__link md-footer__link--next" aria-label="Next: Tutorial">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Tutorial
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright Playbooks AI 2025
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["content.code.annotate", "content.code.copy", "content.code.select", "content.tabs.link", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.instant.progress", "navigation.path", "navigation.top", "navigation.tracking", "toc.follow"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>